@using Tuhu.Provisioning.DataAccess.Entity
@using Tuhu.Provisioning.Models
@using Tuhu.Component.Common.Extensions
@model Tuhu.Component.Common.Models.ListModel<SeekHotWord>
@{
    ViewBag.Title = "热门搜索词";

}
<style>
    .ui-dialog {
        border-radius: 3px;
        padding: 0px;
        width: auto;
    }

    .ui-dialog-grid {
        width: 100%;
    }

    .ui-dialog-title {
        width: 75%;
        padding: 8px 15px 8px 15px;
    }

    .ui-dialog-close {
        top: 8px;
    }

    .ui-dialog-body {
        padding: 10px;
    }

    .ui-dialog-content {
        padding: 0px;
    }

    .ui-dialog-footer {
        padding: 5px 10px 5px 5px;
        background: #ffffff;
        border-top: 1px solid #eee;
    }

        .ui-dialog-footer button {
            padding: 3px 15px;
            border-radius: 2px;
            box-shadow: 0 1px 1px rgba(0,0,0,.15);
            font-size: 12px;
        }

            .ui-dialog-footer button.ui-dialog-autofocus {
                font-weight: 700;
                text-shadow: 1px 1px 1px rgba(0,0,0,0.2);
            }

    .button1 {
        border-radius: 5px;
        padding: 5px 25px;
        border: none;
        color: #F0F0F0;
        font-size: 12px;
        font-family: "Microsoft Yahei";
        outline: none;
        cursor: pointer;
        background: #0088cc;
        border-color: #0088cc;
    }

    table th {
        color: white;
        padding: 6px 5px;
        text-align: left;
        background-color: #0088cc;
        border: solid 1px #0088cc;
    }
</style>
<script src="../../Scripts/ajaxfileupload.js" type="text/javascript"></script>
<link rel="stylesheet" href="/Scripts/artDialog6.0.4/css/ui-dialog.css" />
<script src="~/Scripts/artDialog6.0.4/dist/dialog-min.js"></script>
<script src="~/Scripts/artDialog6.0.4/dist/dialog-plus-min.js"></script>
<div style="margin-top:20px;margin-bottom:20px;">

    <a class="button1" href="/Article/ArticleManage" target="_blank">文章管理</a>
    <a class="button1" href="/Article/Theme" target="_blank">特推主题</a>
    <a class="button1" href="/Article/Hot" target="_blank">热门管理</a>
    <a class="button1" href="/Article/UserSeekKeyWord" target="_blank">用户搜索词</a>

</div>

<div>

    <input type="button" style="float:right;margin-bottom:20px;" class="button1" onclick="Insert()" value="新建" />
</div>
<div>
    <table style="width:100%">
        <thead>
            <tr>
                <th>搜索词</th>
                <th>创建时间</th>
                <th>状态</th>
                <th>操作</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var item in Model.ToList())
            {
                <tr>
                    <td>@item.HotWord</td>
                    <td>@item.CreateTime</td>
                    @if (item.OnOff)
                    {
                        <td>启用</td>
                    }
                    else
                    {
                        <td style="color:red;">禁用</td>
                    }

                    <td>
                        <a href="javascript:;" onclick="deleteModel(@item.id)">删除</a>
                        <a href="javascript:;" onclick="updateItem(@item.id)">修改</a>
                    </td>
                </tr>
            }

        </tbody>
    </table>
</div>
<div>
    @Html.Pager(Model.Pager, pageIndex => Url.RouteUrl(new { pageIndex }))
</div>
<script>

    function updateItem(e){
        var dialgpResult = dialog({
            height: 100,
            width: 300,
            fixed: true,
            title: "搜索词修改",
            button: [
            {
                value: "保存",
                callback: function () {
                    var onOff = false;
                    if ($("#OnOff :selected").val()==0  ) {
                        onOff = true;
                    }
                    else{
                        onOff = false;
                    }
                    $.ajax({
                        type: "POST",
                        url: "/Article/UpdateSeekKeyWord",
                        data: {
                            "id":e,
                            "HotWord": $("#keyWord").val(),
                            "OnOff": onOff
                        },
                        success: function (result) {
                            if (result == 1) {
                                alert("搜索词已经存在！");

                            } else if (result == 2) {
                                window.location.reload(true);
                            }
                            else {
                                alert("保存失败！");
                            }
                        }
                    });
                }
            },
            {
                value: "关闭"
            }]
        });

        $.ajax({
            url: "/Article/AddKeyWord",
            data: {"id":e},
            type: "GET",
            success: function (result) {
                dialgpResult.content(result);
                dialgpResult.showModal();
            }
        });

    };
    function Insert() {
        var dialgpResult = dialog({
            height: 100,
            width: 300,
            fixed: true,
            title: "搜索词添加",
            button: [
            {
                value: "保存",
                callback: function () {
                    var onOff=false;
                    if ($("#OnOff :selected").val()==0) {
                        onOff=true;
                    }
                    else{
                        onOff=false;
                    }
                    $.ajax({
                        type: "POST",
                        url: "/Article/InsertSeekKeyWord",
                        data: {
                            "HotWord": $("#keyWord").val(),
                            "OnOff": onOff
                        },
                        success: function (result) {
                            if (result == 1) {
                                alert("请不要重复添加！");

                            } else if (result == 2) {
                                window.location.reload(true);
                            }
                            else {
                                alert("保存失败！");

                            }
                        }
                    });
                }
            },
            {
                value: "关闭"
            }]
        });

        $.ajax({
            url: "/Article/AddKeyWord",
            data: {},
            type: "GET",
            success: function (result) {

                dialgpResult.content(result);
                dialgpResult.showModal();

            }
        });
    };

    function deleteModel(e) {
        if (confirm("确定要删除吗？")) {
            $.ajax({
                type: "POST",
                url: "/Article/RemoveSeekKeyWord",
                data: { "id": e },
                success: function (result) {
                    if (result) {
                        window.location.reload(true);
                    }
                    else {
                        alert("删除失败！");
                    }
                },
                error: function (result) {
                    alert("错误");
                }
            });
        }
    };

</script>
