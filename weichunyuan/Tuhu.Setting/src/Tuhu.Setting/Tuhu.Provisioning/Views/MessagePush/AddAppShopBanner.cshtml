@model Tuhu.Provisioning.DataAccess.Entity.ShopAppBanner

@{
	Layout = null;
}
<style type="text/css">
	.tr_tb {
		width: 14%;
		text-align: right;
	}

	.tr_td {
		width: 85%;
		text-align: left;
	}
</style>
<link href="../../Scripts/jsColorCss.css" rel="stylesheet" />
<script src="../../Scripts/jscolor.js" type="text/javascript"></script>
<script type="text/javascript">
	$("#custom").spectrum({
		color: $("#BgColor").val()
	});
	$(document).ready(function () {
		$("#StartDate").datepicker({ dateFormat: 'yy-mm-dd' });
		$("#EndDate").datepicker({ dateFormat: 'yy-mm-dd' });
	});
	function SetColor() {
		var bgColor = $("#BgColor").val();
		$('.sp-preview-inner').css('background-color', bgColor);
	}
	$(".sp-val").click(function () {
		var x = $('.sp-preview-inner').css('background-color');
		var color = RGBToHex(x);
		$("#BgColor").val(color);
	})
	function GetType() {
		$("input[name='div_Action']:checked").each(function () {
			if (this.checked) {
				$("#Action").val($(this).val());
			}
		})
	}
	function RGBToHex(rgb) {
		var regexp = /[0-9]{0,3}/g;
		var re = rgb.match(regexp);//利用正则表达式去掉多余的部分，将rgb中的数字提取
		var hexColor = "#"; var hex = ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9', 'A', 'B', 'C', 'D', 'E', 'F'];
		for (var i = 0; i < re.length; i++) {
			var r = null, c = re[i], l = c;
			var hexAr = [];
			while (c > 16) {
				r = c % 16;
				c = (c / 16) >> 0;
				hexAr.push(hex[r]);
			} hexAr.push(hex[c]);
			if (l < 16 && l != "") {
				hexAr.push(0)
			}
			hexColor += hexAr.reverse().join('');
		}
		return hexColor;
	}
	
</script>
<input type="hidden" value="@Model.PKID" id="PKID" />
<table class="tb_table" style="background:#ffffff;font-size:12px;width:100%;">
	<tr>
		<td class="tr_tb">位置或类型：</td>
		<td class="tr_td">
            @*<input type="text" value="@Model.Type" id="Type" style="height:20px;width:85%" />*@
            @Html.DropDownListFor(model => model.Type, new List<SelectListItem>()
            {
                new SelectListItem { Text="店主首页",Value="1" },
                new SelectListItem { Text="员工首页",Value="2" },
                new SelectListItem { Text="店主版品牌积分",Value="3" },
                new SelectListItem { Text="员工版品牌积分",Value="4" }
            })
        </td>
	</tr>
	<tr>
		<td class="tr_tb">主题名称：</td>
		<td class="tr_td"><input type="text" value="@Model.Theme" id="Theme" style="height:20px;width:85%" /></td>
	</tr>
	<tr>
		<td class="tr_tb">大标题：</td>
		<td class="tr_td"><input type="text" value="@Model.MainTitle" id="MainTitle" style="height:20px;width:85%" /><label style="color:red">*</label></td>
	</tr>
	<tr>
		<td class="tr_tb">小标题：</td>
		<td class="tr_td"><input type="text" value="@Model.Contents" id="Contents" style="height:20px;width:85%" /><label style="color:red">*</label></td>
	</tr>
	<tr>
		<td class="tr_tb">动作指令：</td>
		<td class="tr_td">
			<div id="div_checkRadio">
				@*@if (Model.Action == "内嵌webview中打开" || string.IsNullOrEmpty(Model.Action))
				{
					<input type="radio" name="div_Action" value="内嵌webview中打开" checked="checked" onclick="GetType()" /><label>商户版内嵌页面打开 &emsp;</label>
					<input type="radio" name="div_Action" value="唤起某app的某窗口" onclick="GetType()" /><label>唤起车主版页面 &emsp;</label>
					<input type="radio" name="div_Action" value="浏览器中打开" onclick="GetType()" /><label>浏览器中打开</label>
				}
				@if (Model.Action == "唤起某app的某窗口")
				{
					<input type="radio" name="div_Action" value="内嵌webview中打开" onclick="GetType()" /><label>商户版内嵌页面打开 &emsp;</label>
					<input type="radio" name="div_Action" value="唤起某app的某窗口" checked="checked" onclick="GetType()" /><label>唤起车主版页面 &emsp;</label>
					<input type="radio" name="div_Action" value="浏览器中打开" onclick="GetType()" /><label>浏览器中打开</label>
				}
				@if (Model.Action == "浏览器中打开")
				{
					<input type="radio" name="div_Action" value="内嵌webview中打开" onclick="GetType()" /><label>商户版内嵌页面打开 &emsp;</label>
					<input type="radio" name="div_Action" value="唤起某app的某窗口" onclick="GetType()" /><label>唤起车主版页面 &emsp;</label>
					<input type="radio" name="div_Action" value="浏览器中打开" checked="checked" onclick="GetType()" /><label>浏览器中打开</label>
				}*@
                <input type="radio" name="div_Action" value="内嵌webview中打开" @((Model.Action == "内嵌webview中打开"||string.IsNullOrEmpty(Model.Action)) ? "checked='checked'":"")  onclick="GetType()" /><label>商户版内嵌页面打开 &emsp;</label>
                <input type="radio" name="div_Action" value="唤起某app的某窗口" @(Model.Action == "唤起某app的某窗口"?"checked='checked'":"") onclick="GetType()" /><label>唤起车主版页面 &emsp;</label>
                <input type="radio" name="div_Action" value="浏览器中打开" @(Model.Action == "浏览器中打开" ? "checked='checked'":"") onclick="GetType()" /><label>浏览器中打开</label>
                <input type="radio" name="div_Action" value="汽配龙登录" @(Model.Action == "汽配龙登录" ? "checked='checked'" : "") onclick="GetType()" /><label>汽配龙登录</label>
				<input type="hidden" value="@Model.Action" id="Action" />
			</div>
		</td>
	</tr>
	<tr>
		<td class="tr_tb">链接地址：</td>
		<td class="tr_td">
			<input type="text" value="@Model.URL" id="URL" style="height:20px;width:85%" /><label style="color:red">*</label>
		</td>
	</tr>
    <tr>
        <td class="tr_tb">推送类型</td>
        <td class="tr_td"><select id="PushType"><option value="">请选择推送类型</option> <option value="All">全部</option><option value="Factory">工场店</option><option value="GeneralStores">普通门店</option></select></td>
    </tr>
	<tr>
		<td class="tr_tb">有效期：</td>
		<td class="tr_td">
			<input type="text" value="@(Model.StartDate.ToString() == "0001/1/1 0:00:00" ? DateTime.Now.ToString("yyyy-MM-dd") : Model.StartDate.ToString("yyyy-MM-dd"))" id="StartDate" style="width:40%;height:20px" />
			<label>&emsp;至&emsp;</label>
			<input type="text" value="@(Model.EndDate.ToString() == "0001/1/1 0:00:00" ? DateTime.Now.ToString("yyyy-MM-dd") : Model.EndDate.ToString("yyyy-MM-dd"))" id="EndDate" style="width:40%;height:20px" />
		</td>
	</tr>
	<tr>
		<td class="tr_tb">背景颜色：</td>
		<td class="tr_td">
			<input type="text" id="BgColor" name="BgColor" style="width:20%" value="@(Model.BgColor==null?"#ff0000":Model.BgColor)" onblur="SetColor()" />
			<input type='text' id="custom" style="width:120px;height:20px;line-height:15px;" />
		</td>
		<td>
	</tr>
	<tr>
		<td class="tr_tb">图片类型：</td>
		<td class="tr_td">
			<div id="td_checkRadio">
				<input type="radio" name="div_ImgType" value="背景图片" onclick="GetImgType()" checked="checked" />背景图片&emsp;
				<input type="radio" name="div_ImgType" value="头部图片" onclick="GetImgType()" />头部图片&emsp;
				<label style="color:red;" id="BgTextMsg"></label>
				<input type="hidden" value="@Model.ImgType" id="ImgType" />
			</div>
		</td>
	</tr>
	<tr>
		<td class="tr_tb">预览</td>
		<td class="tr_td">
			<div>
				<img id="img_show" style="width:30%;height:30%" src="https://wxbanner.qiniudn.com/%E8%83%8C%E6%99%AF%E5%9B%BE%E7%89%87%E5%B8%83%E5%B1%80.pngimage/png" />
			</div>
		</td>
	</tr>
	<tr>
		<td colspan="2">
			<form id="fm1" method="post" enctype="multipart/form-data">
				<table style="width:100%">
					<tr>
						<td class="tr_tb">图片尺寸一：</td>
						<td class="tr_td">
							<input type="text" value="@Model.ImgUrl1" id="ImgUrl1" style="width:65%;height:20px" disabled="disabled"/><label style="color:red">*</label>
							@*<input type="file" name="file" id="doc" style="width:150px;" onchange="javascript: setImagePreview(this, localImag1, 'preview1');" />*@
							<input style="width:150px;" type="file" id="localImag1" name="localImag1" onchange="UploadBImg('localImag1', 'preview1', 'ImgUrl1');" />
						</td>
					</tr>
					<tr>
						<td class="tr_tb">
							图片宽高像素建议为640：480
						</td>
						<td class="tr_td">
							<div>
								@*<img height="40" src="@Model.ImgUrl1" id="vwPicture" style="width:40px;" />*@
								<img id="preview1" src="@(Model.ImgUrl1 == null ? "https://wxbanner.qiniudn.com/1.pngimage/png" : Model.ImgUrl1)" />
							</div>
						</td>
					</tr>
				</table>
			</form>
		</td>
	</tr>
	<tr>
		<td colspan="2">
			<form id="fm2" method="post" action="/MessagePush/Save" enctype="multipart/form-data">
				<table style="width:100%">
					<tr>
						<td class="tr_tb">图片尺寸二：</td>
						<td class="tr_td">
							<input type="text" value="@Model.ImgUrl2" id="ImgUrl2" style="width:65%;height:20px" disabled="disabled" /><label style="color:red">*</label>
							@*<input type="file" name="file" id="doc" style="width:150px;" onchange="javascript: setImagePreview(this, localImag2, 'preview2');" />*@
							<input style="width:150px;" type="file" id="localImag2" name="localImag2" onchange="UploadBImg('localImag2', 'preview2', 'ImgUrl2');" />
						</td>
					</tr>
					<tr>
						<td class="tr_tb">
							图片宽高像素建议为750：562
						</td>
						<td class="tr_td">
							<div id="localImag2">
								<img id="preview2" src="@(Model.ImgUrl2==null?"https://wxbanner.qiniudn.com/1.pngimage/png":Model.ImgUrl2)" />
							</div>
						</td>
					</tr>
				</table>
			</form>
		</td>
	</tr>
	<tr>
		<td colspan="2">
			<form id="fm3" method="post" action="/MessagePush/Save" enctype="multipart/form-data">
				<table style="width:100%">
					<tr>
						<td class="tr_tb">图片尺寸三：</td>
						<td class="tr_td">
							<input type="text" value="@Model.ImgUrl3" id="ImgUrl3" style="width:65%;height:20px" disabled="disabled" /><label style="color:red">*</label>
							@*<input type="file" name="file" id="doc" style="width:150px;" onchange="javascript: setImagePreview(this, localImag3, 'preview3');" />*@
							<input style="width:150px;" type="file" id="localImag3" name="localImag3" onchange="UploadBImg('localImag3', 'preview3', 'ImgUrl3');" />
						</td>
					</tr>
					<tr>
						<td class="tr_tb">
							图片宽高像素建议为1242：932
						</td>
						<td class="tr_td">
							<div id="localImag3">
								<img id="preview3" src="@(Model.ImgUrl3==null?"http://wxbanner.qiniudn.com/1.pngimage/png":Model.ImgUrl3)" />
							</div>
						</td>
					</tr>
				</table>
			</form>
		</td>
	</tr>
	<tr>
		<td colspan="2">
			<form id="fm4" method="post" action="/MessagePush/Save" enctype="multipart/form-data">
				<table style="width:100%">
					<tr>
						<td class="tr_tb">图片尺寸四：</td>
						<td class="tr_td">
							<input type="text" value="@Model.ImgUrl4" id="ImgUrl4" style="width:65%;height:20px" disabled="disabled" />
							@*<input type="file" name="file" id="doc" style="width:150px;" onchange="javascript: setImagePreview(this, localImag4, 'preview4');" />*@
							<input style="width:150px;" type="file" id="localImag4" name="localImag4" onchange="UploadBImg('localImag4', 'preview4', 'ImgUrl4');" />
						</td>
					</tr>
					<tr>
						<td class="tr_tb">预留位，暂时不用</td>
						<td class="tr_td">
							<div id="localImag4">
								<img id="preview4" src="@(Model.ImgUrl4 == null ? "https://wxbanner.qiniudn.com/1.pngimage/png" : Model.ImgUrl4)" />
							</div>
						</td>
					</tr>
				</table>
			</form>
		</td>
	</tr>
	<tr>
		<td class="tr_tb">备注：</td>
		<td class="tr_td"><input type="text" value="@Model.Remark" id="Remark" style="width:40%;height:20px" /></td>
	</tr>
	
</table>
<script>
    $(function () {
        var pushType='@Model.PushType';
        $("#PushType").val('@Model.PushType');
    });
</script>