@using Tuhu.Provisioning.DataAccess.Entity
@model Advertise
@{
	Layout = null;

}

<script src="../../Scripts/ajaxfileupload.js" type="text/javascript"></script>
<script type="text/javascript">
    $(function () {
        $("#BeginDateTimeHour").val('@Model.BeginDateTime.Value.ToString("HH")');
        $("#BeginDateTimeMinute").val('@Model.BeginDateTime.Value.ToString("mm")');
        $("#EndDateTimeHour").val('@Model.EndDateTime.Value.ToString("HH")');
        $("#EndDateTimeMinute").val('@Model.EndDateTime.Value.ToString("mm")');
        $("#BeginDateTime").datepicker({ dateFormat: 'yy-mm-dd' });
        $("#EndDateTime").datepicker({ dateFormat: 'yy-mm-dd' });
        $("form").submit(function () {
            if ($("#Name").val() == "" || $("#Image").val() == "") {
                alert('模块名称或者图片不能为空');
                return false;
            }
            if (@Model.PKID == 0&&$("#www-QuickBanner").html().indexOf($("#Name").val()) > -1) {
                alert('模块名称已经存在');
                return false;
            }
            var reg = /^[0-9]*$/;
            if (!reg.test($("#Position").val())) {
                alert('排序号须为两位以内的正整数');
                return false;
            }
            var datereg = /^((?:19|20)\d\d)-(0[1-9]|1[012])-(0[1-9]|[12][0-9]|3[01])$/;
            if (!datereg.test($("#BeginDateTime").val())) {
                alert('开始日期格式不正确');
                return false;
            }

            if (!datereg.test($("#EndDateTime").val())) {
                alert('截止日期格式不正确');
                return false;
            }
            $("#BeginDateTime").val($("#BeginDateTime").val() + " " + $("#BeginDateTimeHour").val() + ":" + $("#BeginDateTimeMinute").val() + ":00");
            $("#EndDateTime").val($("#EndDateTime").val() + " " + $("#EndDateTimeHour").val() + ":" + $("#EndDateTimeMinute").val() + ":00");
        });

    });

    function UplaodImg(inputid, imgid, imgviewid) {
        $.ajaxFileUpload({
            url: '/WebSiteHomeAd/ImageUploadToAli',
            secureuri: false,
            fileElementId: inputid,
            dataType: 'text',
            data: {},
            type: "post",
            data: { filepath: "/WebActive/Image/" },
            success: function (src) {
                var wxhost = window.location.host;
                var hostend = wxhost.substring(wxhost.lastIndexOf('.') + 1, wxhost.length);
                if (src != "") {
                    if (hostend != "cn") {
                        $("#" + imgviewid).attr("src", "http://image.tuhu.test" + src);
                        $("#" + imgviewid).show();
                        $("#" + imgid).val("http://image.tuhu.test" + src);
                    } else {
                        $("#" + imgviewid).attr("src", "http://image.tuhu.cn" + src);
                        $("#" + imgviewid).show();
                        $("#" + imgid).val("http://image.tuhu.cn" + src);
                    }
                } else {
                    alert("上传失败！");
                }
            }
        });
    }
    function UplaodImg2(inputid) {
        $.ajaxFileUpload({
            url: '/Advertise/AddWxBannerImg2',
            secureuri: false,
            fileElementId: inputid,
            dataType: 'text',
            data: {},
            type: "post",
            success: function (src) {
                alert(src);
            }
        });
    }
</script>
@using (Html.BeginForm(new { @enctype = "multipart/form-data" }))
{
	@Html.ValidationSummary(true)
	@Html.HiddenFor(m => m.PKID)
	@Html.HiddenFor(m => m.AdColumnID)
	@Html.HiddenFor(m => m.CreateDateTime)
	@Html.HiddenFor(m => m.LastUpdateDateTime)
	@Html.HiddenFor(m => m.Image)
	@Html.HiddenFor(m => m.TopPicture)

	<table style="background:#ffffff;font-size:12px;width:100%;">
		<tr>
			<td align="right" style="width:20%;">模块名称：</td>
			<td style="width:80%;">@Html.TextBoxFor(model => model.Name, new { @style = "width:150px" })</td>
		</tr>
	    <tr>
	        <td align="right">展示图片：</td>
	        <td>
	            <form method="post" action="" enctype="multipart/form-data">
	                <input style="width: 150px;" type="file" id="moduleImg" name="moduleImg" onchange="UplaodImg('moduleImg', 'Image', 'moduleImgView')"/>
	            </form><br/>
	            <img width="225" height="78" src="@Model.Image" id="moduleImgView"/>
	        </td>
	    </tr>
        <tr>
            <td align="right">@Html.CheckBoxFor(model => model.IsSendStamps)是否发券</td>
            <td>@Html.TextBoxFor(model => model.ActivityKey, new {@style = "width:230px"})<span style="color: red">（暂仅供网站电瓶页Banner使用！）</span></td>
        </tr>
		<tr>
			<td align="right">链接URL：</td>
			<td>@Html.TextBoxFor(model => model.Url, new { @style = "width:300px" })</td>
		</tr>
        <tr>
            <td align="right">活动ID：</td>
            <td>@Html.TextBoxFor(model => model.ActivityID, new { @style = "width:300px" })</td>
        </tr>

		<tr>
			<td align="right">排序号：</td>
			<td>@Html.TextBoxFor(model => model.Position, new { @style = "width:150px" }) （需为整数，越小越靠前）</td>
		</tr>
		<tr>
			<td align="right">起止时间：</td>
			<td>
				@Html.TextBoxFor(model => model.BeginDateTime, new { @style = "width:80px;text-align:center;", @readonly = "readonly", @Value = Model.BeginDateTime.Value.ToString("yyyy-MM-dd") })
				<select id="BeginDateTimeHour">
					<option value="00">00时</option>
					<option value="01">01时</option>
					<option value="02">02时</option>
					<option value="03">03时</option>
					<option value="04">04时</option>
					<option value="05">05时</option>
					<option value="06">06时</option>
					<option value="07">07时</option>
					<option value="08">08时</option>
					<option value="09">09时</option>
					<option value="10">10时</option>
					<option value="11">11时</option>
					<option value="12">12时</option>
					<option value="13">13时</option>
					<option value="14">14时</option>
					<option value="15">15时</option>
					<option value="16">16时</option>
					<option value="17">17时</option>
					<option value="18">18时</option>
					<option value="19">19时</option>
					<option value="20">20时</option>
					<option value="21">21时</option>
					<option value="22">22时</option>
					<option value="23">23时</option>
				</select>
				<select id="BeginDateTimeMinute">
					<option value="00">00分</option>
					<option value="10">10分</option>
					<option value="15">15分</option>
					<option value="20">20分</option>
					<option value="25">25分</option>
					<option value="30">30分</option>
					<option value="35">35分</option>
					<option value="40">40分</option>
					<option value="45">45分</option>
					<option value="50">50分</option>
					<option value="55">55分</option>
				</select>
				&nbsp;&nbsp;至&nbsp;&nbsp;
				@Html.TextBoxFor(model => model.EndDateTime, new { @style = "width:80px;text-align:center;", @readonly = "readonly", @Value = Model.EndDateTime.Value.ToString("yyyy-MM-dd") })
				<select id="EndDateTimeHour">
					<option value="00">00时</option>
					<option value="01">01时</option>
					<option value="02">02时</option>
					<option value="03">03时</option>
					<option value="04">04时</option>
					<option value="05">05时</option>
					<option value="06">06时</option>
					<option value="07">07时</option>
					<option value="08">08时</option>
					<option value="09">09时</option>
					<option value="10">10时</option>
					<option value="11">11时</option>
					<option value="12">12时</option>
					<option value="13">13时</option>
					<option value="14">14时</option>
					<option value="15">15时</option>
					<option value="16">16时</option>
					<option value="17">17时</option>
					<option value="18">18时</option>
					<option value="19">19时</option>
					<option value="20">20时</option>
					<option value="21">21时</option>
					<option value="22">22时</option>
					<option value="23">23时</option>
				</select>
				<select id="EndDateTimeMinute">
					<option value="00">00分</option>
					<option value="10">10分</option>
					<option value="15">15分</option>
					<option value="20">20分</option>
					<option value="25">25分</option>
					<option value="30">30分</option>
					<option value="35">35分</option>
					<option value="40">40分</option>
					<option value="45">45分</option>
					<option value="50">50分</option>
					<option value="55">55分</option>
				</select>
			</td>
		</tr>
		<tr>
			<td align="right">显示列数：</td>
			<td>
				@Html.RadioButtonFor(m => m.ShowType, 1) 单列展示
				@Html.RadioButtonFor(m => m.ShowType, 2) 双列展示
			</td>
		</tr>
		<tr>
			<td align="right">状态：</td>
			<td>
				@Html.RadioButtonFor(m => m.State, 1) 启用
				@Html.RadioButtonFor(m => m.State, 0) 停用
			</td>
		</tr>
		<tr>
			<td align="right">列表顶部图片：</td>
			<td>
				<form method="post" action="" enctype="multipart/form-data">
					<input style="width:150px;" type="file" id="TopPictureinputimg" name="TopPictureinputimg" onchange="UplaodImg('TopPictureinputimg', 'TopPicture', 'TopPictureView')" />
				</form><br />
				<img width="225" height="78" src="@Model.TopPicture" id="TopPictureView" />
			</td>
		</tr>
		<tr>
			<td align="right">移动端类型：</td>
			<td>
				@Html.RadioButtonFor(m => m.Platform, 0) 所有
				@Html.RadioButtonFor(m => m.Platform, 1) 电脑
				@Html.RadioButtonFor(m => m.Platform, 2) 微信
				@Html.RadioButtonFor(m => m.Platform, 4) 安卓
				@Html.RadioButtonFor(m => m.Platform, 8) IOS
			</td>
		</tr>
		<tr>
			<td align="right">APP处理值：</td>
			<td>@Html.TextBoxFor(model => model.FunctionID, new { @style = "width:150px" }) （仅供APP使用，其他人谨慎操作）</td>
		</tr>
		<tr>
			<td align="right">广告位类型：</td>
			<td>
				@Html.RadioButtonFor(m => m.AdType, 0) 默认
				@Html.RadioButtonFor(m => m.AdType, 1) 产品位
				@Html.RadioButtonFor(m => m.AdType, 2) 限时抢购
				@Html.RadioButtonFor(m => m.AdType, 3) 活动位
				@Html.RadioButtonFor(m => m.AdType, 4) 车品列表位
			</td>
		</tr>
		<tr>
			<td align="right">产品编号：</td>
			<td>@Html.TextBoxFor(model => model.ProductID, new { @style = "width:150px" })</td>
		</tr>
		<tr>
			<td align="right"></td>
			<td>
				<input type="submit" value="保存" />
				&nbsp;&nbsp;&nbsp;&nbsp;
				<input type="button" value="取消并返回" onclick="location = 'SuppliesModule'" />
			</td>
		</tr>
	</table>
}