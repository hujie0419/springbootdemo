<?xml version="1.0" encoding="utf-8" ?>
<configuration>
    <configSections>
        <section name="log4net" type="log4net.Config.Log4NetConfigurationSectionHandler, log4net" />
    </configSections>
    <log4net>
        <root>
            <level value="INFO" />
            <appender-ref ref="AmqpAppender" />


            <appender-ref ref="SentryAppender" />
        </root>
        <renderer renderingClass="Tuhu.Log.ExceptionRenderer, Tuhu.Log" renderedClass="System.Exception, mscorlib" />
        <appender name="AmqpAppender" type="Tuhu.Log.KafkaAppender, Tuhu.Log">
            <server value="wcf.tuhu.work:19092" />
            <topic type="log4net.Layout.PatternLayout">
                <conversionPattern value="winservicelog" />
            </topic>

            <bodyProperties>
                <property>
                    <name value="Host" />
                    <layout type="Tuhu.Log.IPAddressLayout, Tuhu.Log" />
                </property>
                <property>
                    <name value="Thread" />
                    <layout type="log4net.Layout.PatternLayout">
                        <conversionPattern value="%thread" />
                    </layout>
                </property>
                <property>
                    <name value="Level" />
                    <layout type="log4net.Layout.PatternLayout">
                        <conversionPattern value="%level" />
                    </layout>
                </property>
                <property>
                    <name value="Logger" />
                    <layout type="log4net.Layout.PatternLayout">
                        <conversionPattern value="%logger" />
                    </layout>
                </property>
                <property>
                    <name value="Message" />
                    <!--<layout type="Tuhu.Log.MixMessageLayout, Tuhu.Log" />-->
                    <layout type="log4net.Layout.PatternLayout">
                        <conversionPattern value="%message" />
                    </layout>
                </property>
                <property>
                    <name value="Exception" />
                    <layout type="log4net.Layout.ExceptionLayout" />
                </property>
            </bodyProperties>
        </appender>

        <appender name="SentryAppender" type="Tuhu.Log.SentryAppender, Tuhu.Log.Sentry">
            <DSN value="http://791348f59351471297add857e74de060:f175f6952a6a4c8cbae7e42847d43664@netscaler.ad.tuhu.cn:9000/2" />
            <Logger value="Tuhu.C.ActivityJob" />
            <Timeout value="100" />
            <threshold value="ERROR" />
            <layout type="log4net.Layout.PatternLayout">
                <conversionPattern value="%5level - %message%newline" />
            </layout>
        </appender>
    </log4net>
</configuration>
