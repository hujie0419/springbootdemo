@{
    ViewBag.Title = "";
    Layout = null;
    string group = DateTime.Now.ToString("yyyyMMddHHmmss");
}
@model Tuhu.Provisioning.DataAccess.Entity.ActivityBuildDetail 

<form id="oneFormByOne" class="easyui-form editForm">
    <table  id="oneTableByOne">
        <tr>
            <td>组号:</td>
            <td colspan="2">
                <input type="number" id="Group" name="Group" value="@group" />
            </td>
        </tr>
        <tr>
            <td>
                活动类型:
            </td>
            <td colspan="2">
                <select id="Type" name="Type" onchange="DropDownChange('oneFormByOne')">
                    <option value="-1">请选择</option>
                    @if (Model != null && Model.Type == 0)
                    {
                        <option value="0" selected="selected">轮胎</option>
                    }
                    else
                    {
                        <option value="0">轮胎</option>
                    }

                    @if (Model != null && Model.Type == 1)
                    {
                        <option value="1" selected="selected">车品</option>
                    }
                    else
                    {
                        <option value="1">车品</option>
                    }

                    @if (Model != null && Model.Type == 2)
                    {
                        <option value="2" selected="selected">链接</option>
                    }
                    else
                    {
                        <option value="2">链接</option>
                    }

                    @if (Model != null && Model.Type == 3)
                    {
                        <option value="3" selected="selected">图片</option>
                    }
                    else
                    {
                        <option value="3">图片</option>
                    }

                    @if (Model != null && Model.Type == 4)
                    {
                        <option value="4" selected="selected">优惠卷</option>
                    }
                    else
                    {
                        <option value="4">优惠卷</option>
                    }

                    @if (Model != null && Model.Type == 5)
                    {
                        <option value="5">保养</option>
                    }
                    else
                    {
                        <option value="5">保养</option>
                    }
                    <option value="6">限购轮胎</option>
                    <option value="7">限购车品</option>

                </select>
            </td>
        </tr>
        <tr>
            <td>是否图片:</td>
            <td colspan="2">
                <select id="IsImage" name="IsImage">
                    <option value="0" selected="selected">模板</option>
                    <option value="1">图片</option>
                </select>
            </td>
        </tr>
        <tr id="tr_DisplayWay">
            <td>
                显示方式:
            </td>
            <td colspan="2">
                <select id="DisplayWay" name="DisplayWay">
                    <option value="-1">不选择</option>
                    <option value="0">竖向</option>
                    <option value="1">横向</option>

                </select>
            </td>
        </tr>
        <tr id="tr_PID">
            <td>PID:</td>
            <td colspan="2">
                <input type="text"   id="PID" name="PID" value="@(Model == null?"":Model.PID)" onchange="GetProductImage(this, 'oneTableByOne')" />
            </td>
        </tr>
        <tr id="tr_ProductName">
            <td>产品名称:</td>
            <td colspan="2">
                <input type="text" id="ProductName" name="ProductName"   style="width:300px;"/>
            </td>
        </tr>
        <tr id="tr_VID">
            <td>活动ID：</td>
            <td colspan="2">
                <input type="text"  id="VID" name="VID" value="@(Model == null?"":Model.VID)" pattern="^\w{8}-(\w{4}-){3}\w{12}$"   />
            </td>
        </tr>
        <tr id="tr_CID">
            <td>优惠券ID：</td>
            <td colspan="2">
                <input type="text"  name="CID" value="" onchange="BindCoupon('oneFormByOne')" />
                 
                @*<select name="CID" id="CID">
                    
                </select>*@
            </td>

        </tr>
        <tr>
            <td>图片:</td>
            <td>
                <img id="cimg" width="20" height="20" src="@(Model== null?"":Model.SmallImage)"  />
                <input type="hidden" id="hidCimg" name="hidCimg" value="@(Model == null?"":Model.Image)" />
            </td>
            <td>
                <input id="cFile" type="file" name="cFile" onchange="UploadImg(this, 'cimg', 'hidCimg', 'IsUploading', 'oneTableByOne')" />
                <input type="hidden" id="IsUploading" name="IsUploading" value="@(Model == null?"0":Model.IsUploading.ToString())"/>
             </td>
        </tr>
        @*<tr id="TwoPic"  style="display:none;">
            <td>图片(二):</td>
            <td>
                <img id="cimgTwoPic" width="20" height="20" />
                <input type="hidden" id="hidCimgTwoPic" name="hidCimgTwoPic" />
            </td>
            <td>
                <input id="cFileTwoPic" type="file" name="cFile" onchange="UploadImg(this, 'cimgTwoPic', 'hidCimgTwoPic', 'IsUploading', 'oneTableByOne')"/>
            </td>
        </tr>*@
      
        <tr id="tr_Description">
            <td>描述:</td>
            <td colspan="2">
             
                <textarea name="Description" id="Description"    style="width:280px;height:16px; font-size:12px;  overflow:hidden;">

                </textarea>
            </td>
        </tr>
        <tr id="tr_Url">
            <td>URL:</td>
            <td colspan="2">
                <input type="text"  name="Url" value="@(Model == null?"":Model.LinkUrl)" />
            </td>
        </tr>
        <tr id="tr_WXUrl">
            <td>微信URL：</td>
            <td colspan="2">
                <input type="text" name="WXUrl" value=""/>
            </td>
        </tr>
        <tr id="tr_PCUrl">
            <td>官网URL：</td>
            <td colspan="2">
                <input type="text" name="PCUrl" value=""/>
            </td>
        </tr>
        <tr>
            <td>排序:</td>
            <td colspan="2">
                <input type="text"  name="OrderBy" value="1" style="width:300px;"   />
            </td>
        </tr>
        <tr style="display:none;">
            <td>轮胎品牌:</td>
            <td colspan="2">
                <select id="TireBrand" name="TireBrand">
                    <option value="-1">不选择</option>
                </select>
            </td>
        </tr>
        <tr id="tr_HandlerIOS">
            <td colspan="2">APP处理值(IOS):</td>
            <td>
                <input type="text"  name="HandlerIOS" value="" />
                <span style="color:red;">必填</span>
            </td>
        </tr>
        <tr id="tr_HandlerAndroid">
            <td colspan="2">APP处理值(Android):</td>
            <td>
                <input type="text"  name="HandlerAndroid" value="" />
                <span style="color:red;">必填</span>
             </td>
        </tr>
        <tr id="tr_SOAPIOS">
            <td colspan="2">特殊通讯值(IOS):</td>
            <td>
                <input type="text"  name="SOAPIOS" value="" />
                <span style="color:red;">必填</span>
            </td>
        </tr>
        <tr id="tr_SOAPAndroid">
            <td colspan="2">特殊通讯值(Android)：</td>
            <td>
                <input type="text"  name="SOAPAndroid" value="" />
                <span style="color:red;">必填</span>
            </td>
        </tr>
        <tr id="tr_Handler">
            <td colspan="3">
                <span style="color:red;">【特殊通讯值】填写时，不用单引号【'】以及不用中括号【[]】例如(不符合格式):{'name':'value','key':1} 、[{"name":"value","key":1} ]</span>
            </td>
        </tr>
    </table>

</form>

<script type="text/javascript">

    function getDataRow() {
        var date = $('#oneTableByOne [name=Group]').val();//(new Date()).Format("yyyyMMddhhmmss");
        
        var data = {
            'Group':date,
            'PID': $('#oneTableByOne [name=PID]').val(),
            'VID': $('#oneTableByOne [name=VID]').val(),
            'CID': $('#oneTableByOne [name=CID]').val(),
            'SmallImage': $('#oneTableByOne [id=cimg]').attr('src')||'', //小图路径
            'Image': $('#oneTableByOne [name=hidCimg]').val(), //大图
            'BigImg': 0,
            'Type': $('#oneTableByOne [name=Type]').val(), //类型
            'OrderBy': $('#oneTableByOne [name=OrderBy]').val(),
            'LinkUrl': $('#oneTableByOne [name=Url]').val(),
            'HandlerIOS': $('#oneTableByOne [name=HandlerIOS]').val(),
            'HandlerAndroid': $('#oneTableByOne [name=HandlerAndroid]').val(),
            'SOAPIOS': $('#oneTableByOne [name=SOAPIOS]').val(),
            'SOAPAndroid': $('#oneTableByOne [name=SOAPAndroid]').val(),
            'IsUploading': $('#oneTableByOne [name=IsImage]').val(),    //$('#oneTableByOne [name=IsUploading]').val() || 0
            'DisplayWay': $('#oneTableByOne [name=DisplayWay]').val(),//显示方式
            'Description': $('#oneTableByOne [name=Description]').val() //描述
        };
        if (data.Type == 4) {
            //优惠卷
            data.TwoSImage = $('#oneTableByOne [id=cimgTwoPic]').attr('src') || '';
            data.TwoBImage = $('#oneTableByOne [name=hidCimgTwoPic]').val(); 
        }
        
        //if ($('#oneTableByOne [name=TireBrand]').val() != -1) {
        //    //选择车牌
        //    data.TireBrand = $('#oneTableByOne [name=TireBrand]').val();
        //}

        if ((data.Type == 0 || data.Type == 1 || data.Type == 6 || data.Type == 7) && data.IsUploading == 0) {
            data.ProductName = $('#oneTableByOne [name=ProductName]').val();
        }


        data.WXUrl = $('#oneTableByOne [name=WXUrl]').val();
        data.PCUrl = $('#oneTableByOne [name=PCUrl]').val();
        return data;

    }

   

</script>