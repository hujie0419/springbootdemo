webpackJsonp([4],{"+skl":function(e,t){},"0mhl":function(e,t){},"4Kt1":function(e,t){},"9Q9G":function(e,t){},NHnr:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("7+uW"),o={props:{name:{type:String}},methods:{logout:function(){this.$emit("logout")}}},i={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"header"},[e._m(0),e._v(" "),a("div",{staticClass:"header-aside"},[a("Dropdown",{on:{"on-click":e.logout}},[a("a",{staticClass:"header-aside-main",attrs:{href:"javascript:void(0)"}},[a("Icon",{staticClass:"main-icon",attrs:{type:"ios-person"}}),e._v("\n          "+e._s(e.name)+"\n          "),a("Icon",{attrs:{type:"arrow-down-b"}})],1),e._v(" "),a("DropdownMenu",{attrs:{slot:"list"},slot:"list"},[a("DropdownItem",[e._v("退出登录")])],1)],1)],1)])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"headerlogo"},[t("img",{staticClass:"header-logo-line",attrs:{src:"static/logo.png"}}),this._v(" "),t("div",{staticClass:"header-logo-title"},[t("h3",[this._v("第三方运营系统")]),this._v(" "),t("h4",[this._v("setting.tuhu.cn")])])])}]};var s=a("VU/8")(o,i,!1,function(e){a("bh8J")},null,null).exports,l={name:"setting-menu",props:{menus:{type:Array}},data:function(){return{searchVal:"",filteredMenus:[],openedmenus:[],shrinked:!1,activename:""}},watch:{$route:function(){this.setActiveName(this.$router.currentRoute.name)}},mounted:function(){this.filteredMenus=this.menus,this.setActiveName(this.$router.currentRoute.name)},methods:{goto:function(e){this.$router.push({name:e})},fliter:function(){var e=this.searchVal;this.filteredMenus=this.menus.filter(function(t){return t.name.indexOf(e)>=0}),this.updateOpenedMenus(this.util.array.select(this.filteredMenus,function(e){return e.key}))},updateOpenedMenus:function(e,t){this.openedmenus=e,t&&(this.activename=t),this.$nextTick(function(){this.$refs.orangeMenu.updateOpened(),this.$refs.orangeMenu.updateActiveName()})},setActiveName:function(e){var t;this.menus.forEach(function(a){a.children.forEach(function(n){n.key===e&&(t=a.key)})}),t&&this.updateOpenedMenus([t],e)}}},r={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{class:{nav:!e.shrinked}},[a("Input",{staticClass:"search",attrs:{icon:"ios-search",placeholder:"筛选一级目录"},on:{"on-enter":e.fliter,"on-click":e.fliter},model:{value:e.searchVal,callback:function(t){e.searchVal=t},expression:"searchVal"}}),e._v(" "),a("Menu",{ref:"orangeMenu",attrs:{width:"210px","open-names":e.openedmenus,"active-name":e.activename},on:{"on-select":e.goto}},e._l(e.filteredMenus,function(t,n){return a("Submenu",{key:n,attrs:{name:t.key}},[a("template",{slot:"title"},[a("Icon",{attrs:{type:t.icon}}),e._v("\n                "+e._s(t.name)+"\n            ")],1),e._v(" "),e._l(t.children,function(t,n){return a("MenuItem",{key:n,attrs:{name:t.key}},[e._v("\n            "+e._s(t.name)+"\n            ")])})],2)})),e._v(" "),a("Button",{directives:[{name:"show",rawName:"v-show",value:e.shrinked,expression:"shrinked"}],staticClass:"hide",on:{click:function(t){e.shrinked=!e.shrinked}}},[e._v("收起")])],1)},staticRenderFns:[]};var u={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"footer"},[t("div",{staticClass:"footer-data"},[t("span",[this._v("所有内容为途虎养车网商业机密信息，切勿泄漏。版权所有 途虎养车网 2011-2015")])])])}]};var d={name:"App",data:function(){return{user:{name:""}}},computed:{menus:function(){return this.$store.state.app.menus},username:function(){return this.$store.state.user.name}},components:{settingheader:s,settingmenu:a("VU/8")(l,r,!1,function(e){a("X0mD")},null,null).exports,settingfooter:a("VU/8")({},u,!1,function(e){a("ROvl")},null,null).exports},methods:{logout:function(){var e=location.hostname.replace("yunying","yewu").replace("setting","yewu");window.location.href=location.protocol+"//"+e+"/Account/LogOff"}}},c={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("settingheader",{attrs:{name:this.username},on:{logout:this.logout}}),this._v(" "),t("settingmenu",{attrs:{menus:this.menus}}),this._v(" "),t("div",{staticClass:"content"},[t("div",{staticClass:"real-content"},[t("router-view")],1),this._v(" "),t("div",{staticStyle:{height:"50px"}}),this._v(" "),t("settingfooter")],1)],1)},staticRenderFns:[]};var p,h,g=a("VU/8")(d,c,!1,function(e){a("0mhl")},null,null).exports,m=a("BTaQ"),f=a.n(m),v=(a("+skl"),a("9Q9G"),a("mvHQ")),_=a.n(v),b=a("//Fk"),I=a.n(b),D=a("mtWM"),S=a.n(D),k={};k.title=function(e){e=e||"途虎第三方运营系统",window.document.title=e},S.a.interceptors.request.use(function(e){return h.start(),e},function(e){return h.error(),I.a.reject(e)}),S.a.interceptors.response.use(function(e){console.log(e);var t=/Msg[\s|\S]*[-]*.*IsPower/;return t.test(e.data)&&k.message.error({content:e.data.match(t)[0].replace("Msg:","").replace(",IsPower",""),duration:10,closable:!0}),h.finish(),e},function(e){h.error(),p.error({content:_()(e.response.data),duration:10,closable:!0})}),k.ajax=S.a,k.axiosInstance=S.a.create(),k.useMessage=function(e){p=e,k.message=p,console.log("use meseage"),console.log(e)},k.useLoadingbar=function(e){h=e},k.array={},k.array.select=function(e,t){var a=[];return e.forEach(function(e,n){a.push(t(e))}),a},k.deepCopy=function(e){return JSON.parse(_()(e))};var x=k,C=a("NYxO"),y={namespaced:!0,state:{menu:{menus:[],openedmenus:[],shrinked:[]},user:{name:"",permission:[]}},mutations:{init:function(e,t){console.log(t),e.menus=t}}},T={namespaced:!0,state:{name:"",permissions:[]},mutations:{logout:function(e){},init:function(e,t){e.name=t.name,e.permissions=t.permissions}}};n.default.use(C.a);var $=new C.a.Store({state:{},mutations:{},actions:{},modules:{app:y,user:T}}),N=[{key:"1",name:"大众点评美容团购",icon:"ios-speedometer",children:[{key:"gpconfig",name:"团购配置"},{key:"shopconfig",name:"门店维护"}]}];n.default.use(f.a),n.default.config.productionTip=!1,n.default.prototype.ajax=x.ajax,n.default.prototype.util=x,console.log(n.default.prototype.$Message),x.useMessage(n.default.prototype.$Message),n.default.prototype.$Loading.config({color:"#2ca9e1",failedColor:"#c9171e",height:2}),x.useLoadingbar(n.default.prototype.$Loading),x.ajax.get("/auth/GetBasicInformantion").then(function(e){if(e.data.success){$.commit("user/init",e.data.user),$.commit("app/init",N);var t=a("YaEn").default;t.beforeEach(function(e,t,a){(f.a.LoadingBar.start(),x.title(e.meta.title),console.log("pat"+e.meta.authpath),e.meta.authpath)?x.axiosInstance.get("/auth/haspower?path="+e.meta.authpath).then(function(e){e.data.success&&e.data.result?a():a({path:"/403"})}).catch(function(e){console.log(e),f.a.LoadingBar.error(),a({path:"/500"})}):a()}),t.afterEach(function(e){console.log("finish"),f.a.LoadingBar.finish()}),new n.default({el:"#app",router:t,store:$,components:{App:g},template:"<App/>"})}else{var o=location.hostname.replace("yunying","yewu").replace("setting","yewu");window.location.href=location.protocol+"//"+o+"/Account/LogOn?ReturnUrl="+location.href}})},ROvl:function(e,t){},X0mD:function(e,t){},YaEn:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("7+uW"),o=a("/ocq"),i={render:function(){var e=this.$createElement;return(this._self._c||e)("div",[this._v("\n    欢迎访问途虎第三方运营系统！\n")])},staticRenderFns:[]},s=a("VU/8")(null,i,!1,null,null,null).exports,l=a("Dd8w"),r=a.n(l),u=a("woOf"),d=a.n(u),c={dianpingid:"",dianpingbrand:"",dianpingname:"",tuhupid:"",tuhustatus:"-1"},p={PKID:0,DianpingGroupId:"",DianpingBrand:"",DianpingTuanName:"",TuhuProductId:"",TuhuProductName:"",TuhuProductStatus:0},h={data:function(){var e=this;return{select_data:[{value:1,text:"已上架"},{value:0,text:"已下架"}],search_data:{},page:{total:0,current:1,pageSize:20},table:{loading:!0,data:[],columns:[{title:"点评团购ID",key:"DianpingGroupId"},{title:"点评品牌名称",key:"DianpingBrand"},{title:"点评团购名称",key:"DianpingTuanName"},{title:"途虎服务产品ID",key:"TuhuProductId"},{title:"途虎服务产品名称",key:"TuhuProductName"},{title:"途虎服务状态",key:"Status",render:function(e,t){return e("span",{},1===t.row.TuhuProductStatus?"已上架":"未上架")}},{title:"操作",key:"action",width:150,align:"center",render:function(t,a){return t("div",[t("Button",{props:{type:"primary",size:"small"},style:{marginRight:"5px"},on:{click:function(){e.modal.visible=!0,e.modal.edit=!0,e.modal.gpConfig=e.util.deepCopy(e.table.data[a.index]),e.modal.title="编辑大众点评美容团购"}}},"编辑"),t("Button",{props:{type:"error",size:"small"},on:{click:function(){e.deleteModal.dianpingGroupId=e.table.data[a.index].DianpingGroupId,e.deleteModal.visible=!0}}},"删除")])}}]},deleteModal:{visible:!1,loading:!0,dianpingGroupId:""},modal:{visible:!1,loading:!0,edit:!0,title:"",gpConfig:{PKID:0,DianpingGroupId:"",DianpingBrand:"",DianpingTuanName:"",TuhuProductId:"",TuhuProductName:"",TuhuProductStatus:0},rules:{DianpingGroupId:[{required:!0,message:"请输入点评团购ID",trigger:"blur"}],DianpingBrand:[{required:!0,message:"点评品牌名称",trigger:"blur"}],DianpingTuanName:[{required:!0,message:"点评团购名称",trigger:"blur"}],TuhuProductId:[{required:!0,message:"请输入途虎服务产品ID",trigger:"blur"}],TuhuProductName:[{required:!0,message:"请输入正确的服务Id",trigger:"blur"}]}}}},created:function(){this.search_data=d()({},c),this.loadData()},methods:{loadData:function(){var e=this;this.table.loading=!0,this.ajax.get("/dianping/getgroupconfigs",{params:r()({},this.search_data,{pageIndex:this.page.current,pageSize:this.page.pageSize})}).then(function(t){var a=t.data;e.page.total=a.totalCount,e.page.current=a.pageIndex,e.table.data=a.data,e.table.loading=!1})},handlePageChange:function(e){this.page.current=e,this.loadData()},handlePageSizeChange:function(e){this.page.pageSize=e,this.loadData()},handleFormatError:function(e){console.log(123),this.util.message.warning({content:e.name+" 格式错误，必须是xls或xlsx文件",duration:3,closable:!0})},handleResetForm:function(){this.search_data=d()({},c)},setProductName:function(){var e=this;this.modal.gpConfig.TuhuProductId&&this.ajax.get("/Dianping/GetTuhuProductName?tuhuProductId="+this.modal.gpConfig.TuhuProductId).then(function(t){t.data.name?e.modal.gpConfig.TuhuProductName=t.data.name:e.modal.gpConfig.TuhuProductName=""})},ok:function(){var e=this;this.modal.loading=!0,this.$refs["modal.gpConfig"].validate(function(t){if(t){console.log(e.$http);var a=!1;e.modal.gpConfig.PKID>0&&(a=!0),e.ajax.post(a?"/Dianping/UpdateGroupConfig":"/Dianping/InsertGroupConfig",e.modal.gpConfig).then(function(t){console.log(t),t.data.success?setTimeout(function(){e.$Message.success(a?"更新成功":"添加成功"),e.loadData(),e.modal.gpConfig=d()({},p),e.modal.visible=!1,e.modal.loading=!1,e.$nextTick(function(){e.modal.loading=!0})},2e3):(e.$Message.error(t.data.msg),e.modal.loading=!1,e.$nextTick(function(){e.modal.loading=!0}))})}else e.modal.loading=!1,e.$nextTick(function(){e.modal.loading=!0})})},cancel:function(){this.modal.gpConfig=d()({},p),this.$refs["modal.gpConfig"].resetFields()},deleteok:function(){var e=this;this.deleteModal.loading=!0,this.ajax.post("/Dianping/DeleteGroupConfig",{dianpingGroupId:this.deleteModal.dianpingGroupId}).then(function(t){console.log(t),t.data.success?setTimeout(function(){e.$Message.success("删除成功"),e.loadData(),e.deleteModal.loading=!1,e.deleteModal.visible=!1,e.$nextTick(function(){e.deleteModal.loading=!0})},2e3):(console.log(e.deleteModal),e.$Message.error("删除失败"),e.deleteModal.loading=!1,e.$nextTick(function(){e.deleteModal.loading=!0}))})},uploadSuccess:function(e,t){var a=this;e.success?setTimeout(function(){a.$Message.success("上传成功"),a.loadData()},2e3):this.$Message.error({content:e.msg,duration:0,closable:!0})}}},g={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("h1",{staticClass:"title"},[e._v("团购配置")]),e._v(" "),a("Form",{attrs:{model:e.search_data,"label-width":100}},[a("Row",[a("Col",{attrs:{span:"6"}},[a("FormItem",{attrs:{label:"点评团购ID:"}},[a("Input",{attrs:{placeholder:"点评团购ID"},model:{value:e.search_data.dianpingid,callback:function(t){e.$set(e.search_data,"dianpingid",t)},expression:"search_data.dianpingid"}})],1)],1),e._v(" "),a("Col",{attrs:{span:"6"}},[a("FormItem",{attrs:{label:"点评品牌名称:"}},[a("Input",{attrs:{placeholder:"点评品牌名称"},model:{value:e.search_data.dianpingbrand,callback:function(t){e.$set(e.search_data,"dianpingbrand",t)},expression:"search_data.dianpingbrand"}})],1)],1),e._v(" "),a("Col",{attrs:{span:"6"}},[a("FormItem",{attrs:{label:"点评团购名称:"}},[a("Input",{attrs:{placeholder:"点评团购名称"},model:{value:e.search_data.dianpingname,callback:function(t){e.$set(e.search_data,"dianpingname",t)},expression:"search_data.dianpingname"}})],1)],1)],1),e._v(" "),a("Row",[a("Col",{attrs:{span:"6"}},[a("FormItem",{attrs:{label:"途虎服务产品ID:"}},[a("Input",{attrs:{placeholder:"途虎服务产品ID"},model:{value:e.search_data.tuhupid,callback:function(t){e.$set(e.search_data,"tuhupid",t)},expression:"search_data.tuhupid"}})],1)],1),e._v(" "),a("Col",{attrs:{span:"6"}},[a("FormItem",{attrs:{label:"途虎服务状态:"}},[a("Select",{model:{value:e.search_data.tuhustatus,callback:function(t){e.$set(e.search_data,"tuhustatus",t)},expression:"search_data.tuhustatus"}},[a("Option",{attrs:{value:"-1"}},[e._v("全部")]),e._v(" "),a("Option",{attrs:{value:"1"}},[e._v("已上架")]),e._v(" "),a("Option",{attrs:{value:"0"}},[e._v("未上架")])],1)],1)],1)],1),e._v(" "),a("Row",{staticStyle:{"margin-bottom":"15px"}},[a("Button",{staticStyle:{"margin-left":"8px",float:"left"},attrs:{type:"primary"},on:{click:function(t){e.page.current=1,e.loadData()}}},[e._v("查询")]),e._v(" "),a("Button",{staticStyle:{"margin-left":"8px",float:"left"},attrs:{type:"ghost"},on:{click:e.handleResetForm}},[e._v("重置")]),e._v(" "),a("Button",{staticStyle:{"margin-left":"8px",float:"left"},attrs:{type:"success"},on:{click:function(t){e.modal.edit=!1,e.modal.visible=!0,e.modal.title="新增大众点评美容团购"}}},[e._v("新增")]),e._v(" "),a("Upload",{staticStyle:{"margin-left":"8px",display:"inline",float:"left"},attrs:{action:"/dianping/upload?type=groupconfig",format:["xlsx","xls"],"on-format-error":e.handleFormatError,"max-size":200,"on-success":e.uploadSuccess}},[a("Button",{attrs:{type:"warning",icon:"ios-cloud-upload-outline"}},[e._v("批量导入")])],1),e._v(" "),a("a",{staticStyle:{"margin-left":"8px","margin-top":"7px",display:"inline",float:"left"},attrs:{href:"/Dianping/ExportSample?type=groupconfig",target:"_blank"}},[e._v("导出模板文件")])],1)],1),e._v(" "),a("Table",{attrs:{border:"",loading:e.table.loading,columns:e.table.columns,data:e.table.data}}),e._v(" "),a("div",{staticStyle:{"margin-top":"15px",float:"right"}},[a("Page",{attrs:{total:e.page.total,"page-size":e.page.pageSize,current:e.page.current,"page-size-opts":[20,50,100],"show-elevator":"","show-sizer":""},on:{"on-change":e.handlePageChange,"on-page-size-change":e.handlePageSizeChange}})],1),e._v(" "),a("Modal",{attrs:{loading:e.modal.loading,title:e.modal.title,okText:"提交",cancelText:"取消"},on:{"on-ok":e.ok,"on-cancel":e.cancel},model:{value:e.modal.visible,callback:function(t){e.$set(e.modal,"visible",t)},expression:"modal.visible"}},[a("Form",{ref:"modal.gpConfig",attrs:{model:e.modal.gpConfig,rules:e.modal.rules,"label-position":"left","label-width":150}},[a("FormItem",{attrs:{label:"点评团购ID",prop:"DianpingGroupId"}},[a("Input",{attrs:{disabled:e.modal.edit,placeholder:""},model:{value:e.modal.gpConfig.DianpingGroupId,callback:function(t){e.$set(e.modal.gpConfig,"DianpingGroupId",t)},expression:"modal.gpConfig.DianpingGroupId"}})],1),e._v(" "),a("FormItem",{attrs:{label:"点评品牌名称",prop:"DianpingBrand"}},[a("Input",{attrs:{placeholder:""},model:{value:e.modal.gpConfig.DianpingBrand,callback:function(t){e.$set(e.modal.gpConfig,"DianpingBrand",t)},expression:"modal.gpConfig.DianpingBrand"}})],1),e._v(" "),a("FormItem",{attrs:{label:"点评团购名称",prop:"DianpingTuanName"}},[a("Input",{attrs:{placeholder:""},model:{value:e.modal.gpConfig.DianpingTuanName,callback:function(t){e.$set(e.modal.gpConfig,"DianpingTuanName",t)},expression:"modal.gpConfig.DianpingTuanName"}})],1),e._v(" "),a("FormItem",{attrs:{label:"途虎服务产品ID",prop:"TuhuProductId"}},[a("Input",{attrs:{placeholder:""},on:{"on-change":e.setProductName},model:{value:e.modal.gpConfig.TuhuProductId,callback:function(t){e.$set(e.modal.gpConfig,"TuhuProductId",t)},expression:"modal.gpConfig.TuhuProductId"}})],1),e._v(" "),a("FormItem",{attrs:{label:"途虎服务产品名称",prop:"TuhuProductName"}},[a("Input",{attrs:{disabled:!0,placeholder:""},model:{value:e.modal.gpConfig.TuhuProductName,callback:function(t){e.$set(e.modal.gpConfig,"TuhuProductName",t)},expression:"modal.gpConfig.TuhuProductName"}})],1),e._v(" "),a("FormItem",{attrs:{label:"途虎服务状态"}},[a("Select",{model:{value:e.modal.gpConfig.TuhuProductStatus,callback:function(t){e.$set(e.modal.gpConfig,"TuhuProductStatus",t)},expression:"modal.gpConfig.TuhuProductStatus"}},e._l(e.select_data,function(t){return a("Option",{key:t.value,attrs:{value:t.value}},[e._v(e._s(t.text))])}))],1)],1)],1),e._v(" "),a("Modal",{attrs:{title:"删除",loading:e.deleteModal.loading},on:{"on-ok":e.deleteok},model:{value:e.deleteModal.visible,callback:function(t){e.$set(e.deleteModal,"visible",t)},expression:"deleteModal.visible"}},[a("p",[e._v("确认删除？")])])],1)},staticRenderFns:[]};var m=a("VU/8")(h,g,!1,function(e){a("4Kt1")},null,null).exports,f=a("mvHQ"),v=a.n(f),_={DianpingId:"",DianpingName:"",DianpingShopName:"",TuhuShopId:"",GroupStatus:"-1",LinkStatus:"-1"},b={PKID:0,DianpingId:"",DianpingName:"",DianpingShopName:"",TuhuShopId:"",TuhuShopName:"",GroupStatus:0},I={data:function(){var e=this;return{select_data:[{value:1,text:"已配置"},{value:0,text:"未配置"}],search_data:{},page:{total:0,current:1,pageSize:20},table:{loading:!0,data:[],columns:[{type:"selection",width:60,align:"center"},{title:"点评门店ID",key:"DianpingId"},{title:"点评商户名",key:"DianpingName"},{title:"点评分店名",key:"DianpingShopName"},{title:"途虎门店ID",key:"TuhuShopId"},{title:"途虎门店名称",key:"TuhuShopName"},{title:"点评团购",key:"GroupStatus",render:function(e,t){return e("span",{},1===t.row.GroupStatus?"已配置":"未配置")}},{title:"关联点评管家",key:"LinkStatus",render:function(e,t){return e("span",{},null!==t.row.Session?t.row.Session.RefreshToken?"已关联":"即将过期":"未关联")}},{title:"操作",key:"action",width:200,align:"center",render:function(t,a){return t("div",[t("Button",{props:{type:"primary",size:"small"},style:{marginRight:"5px"},on:{click:function(){e.modal.visible=!0,e.modal.edit=!0,e.modal.shopConfig=e.util.deepCopy(e.table.data[a.index]),e.modal.title="编辑大众点评美容团购"}}},"编辑"),t("Button",{props:{type:"error",size:"small"},on:{click:function(){e.deleteModal.dianpingId=e.table.data[a.index].DianpingId,e.deleteModal.visible=!0}}},"删除"),t("Button",{props:{type:"warning",size:"small",disabled:null==a.row.Session||""!==a.row.Session.RefreshToken&&null!=a.row.Session.RefreshToken},style:{marginLeft:"5px"},on:{click:function(){e.reAuth(e.table.data[a.index])}}},"重新授权")])}}]},selectedTableData:[],deleteModal:{visible:!1,loading:!0,dianpingId:""},modal:{visible:!1,loading:!0,edit:!0,title:"",shopConfig:{PKID:0,DianpingId:"",DianpingName:"",DianpingShopName:"",TuhuShopId:"",TuhuShopName:"",GroupStatus:0},rules:{DianpingId:[{required:!0,message:"请输入点评门店ID",trigger:"blur"}],DianpingName:[{required:!0,message:"请输入点评点评商户名",trigger:"blur"}],DianpingShopName:[{required:!0,message:"请输入点评分店名",trigger:"blur"}],TuhuShopId:[{validator:function(e,t,a){""===t||isNaN(t)?a(new Error("请输入途虎门店数字ID")):a()},trigger:"blur"}],TuhuShopName:[{required:!0,message:"请输入正确的途虎门店ID",trigger:"blur"}]}}}},created:function(){this.search_data=d()({},_),this.loadData()},methods:{loadData:function(){var e=this;this.table.loading=!0,this.ajax.get("/dianping/getshopconfigs",{params:r()({},this.search_data,{pageIndex:this.page.current,pageSize:this.page.pageSize})}).then(function(t){var a=t.data;e.page.total=a.totalCount,e.page.current=a.pageIndex,e.table.data=a.data,e.table.loading=!1})},handlePageChange:function(e){this.page.current=e,this.loadData()},handlePageSizeChange:function(e){this.page.pageSize=e,this.loadData()},handleFormatError:function(e){console.log(123),this.util.message.warning({content:e.name+" 格式错误，必须是xls或xlsx文件",duration:3,closable:!0})},handleResetForm:function(){this.search_data=d()({},_)},setShopName:function(){var e=this;this.modal.shopConfig.TuhuShopId&&!isNaN(this.modal.shopConfig.TuhuShopId)&&this.ajax.get("/Dianping/GetTuhuShopName?tuhuShopId="+this.modal.shopConfig.TuhuShopId).then(function(t){t.data.name?e.modal.shopConfig.TuhuShopName=t.data.name:e.modal.shopConfig.TuhuShopName=""})},ok:function(){var e=this;this.modal.loading=!0,this.$refs["modal.shopConfig"].validate(function(t){if(console.log(t),t){console.log(e.$http);var a=!1;e.modal.shopConfig.PKID>0&&(a=!0),e.ajax.post(a?"/Dianping/UpdateShopConfig":"/Dianping/InsertShopConfig",e.modal.shopConfig).then(function(t){console.log(t),t.data.success?setTimeout(function(){e.$Message.success(a?"更新成功":"添加成功"),e.loadData(),e.modal.shopConfig=d()({},b),e.modal.visible=!1,e.modal.loading=!1,e.$nextTick(function(){e.modal.loading=!0})},2e3):(e.$Message.error(t.data.msg),e.modal.loading=!1,e.$nextTick(function(){e.modal.loading=!0}))})}else e.modal.loading=!1,e.$nextTick(function(){e.modal.loading=!0})})},cancel:function(){this.modal.shopConfig=d()({},b),this.$refs["modal.shopConfig"].resetFields()},deleteok:function(){var e=this;this.deleteModal.loading=!0,this.ajax.post("/Dianping/DeleteShopConfig",{dianpingId:this.deleteModal.dianpingId}).then(function(t){console.log(t),t.data.success?setTimeout(function(){e.$Message.success("删除成功"),e.loadData(),e.deleteModal.loading=!1,e.deleteModal.visible=!1,e.$nextTick(function(){e.deleteModal.loading=!0})},2e3):(console.log(e.deleteModal),e.$Message.error("删除失败"),e.deleteModal.loading=!1,e.$nextTick(function(){e.deleteModal.loading=!0}))})},uploadSuccess:function(e,t){var a=this;e.success?setTimeout(function(){a.$Message.success("上传成功"),a.loadData()},2e3):this.$Message.error({content:e.msg,duration:0,closable:!0})},selectChange:function(e){this.selectedTableData=e},get:function(){var e=[];this.selectedTableData.forEach(function(t){e.push({shopAddress:t.TuhuShopAddress,shopName:t.TuhuShopName,shopId:t.TuhuShopId})});var t="https://e.dianping.com/open/merchant/auth?appKey=075c10a2cb7be033&requestModules="+encodeURIComponent(v()([5]))+"&shopList="+encodeURIComponent(v()([{shopAddress:"莘松路1260号(亚繁生活时尚广场隔壁)",shopId:"117271",shopName:"途虎养车工场店 莘松路店"}]));window.open(t)},link:function(){var e=document.createElement("form");e.action="https://e.dianping.com/open/merchant/auth",e.target="_blank",e.method="post",e.style.display="none";var t=[];this.selectedTableData.forEach(function(e){t.push({shopAddress:e.TuhuShopAddress,shopId:e.TuhuShopId,shopName:e.TuhuShopName})}),[{key:"appKey",value:"075c10a2cb7be033"},{key:"requestModules",value:v()([1,3,5,6,8])},{key:"shopList",value:v()(t)}].forEach(function(t){var a=document.createElement("textarea");a.name=t.key,a.value=t.value,e.appendChild(a)}),document.body.appendChild(e),console.log(e),e.submit()},reAuth:function(e){var t=e.Session.Session,a="https://e.dianping.com/open/merchant/reauthorize?app_key=075c10a2cb7be033&app_shopid="+e.TuhuShopId+"&session="+t;window.open(a)}}},D={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("h1",{staticClass:"title"},[e._v("门店维护")]),e._v(" "),a("Form",{attrs:{model:e.search_data,"label-width":100}},[a("Row",[a("Col",{attrs:{span:"6"}},[a("FormItem",{attrs:{label:"点评门店ID:"}},[a("Input",{attrs:{placeholder:"点评门店ID"},model:{value:e.search_data.DianpingId,callback:function(t){e.$set(e.search_data,"DianpingId",t)},expression:"search_data.DianpingId"}})],1)],1),e._v(" "),a("Col",{attrs:{span:"6"}},[a("FormItem",{attrs:{label:"点评商户名:"}},[a("Input",{attrs:{placeholder:"点评商户名"},model:{value:e.search_data.DianpingName,callback:function(t){e.$set(e.search_data,"DianpingName",t)},expression:"search_data.DianpingName"}})],1)],1),e._v(" "),a("Col",{attrs:{span:"6"}},[a("FormItem",{attrs:{label:"点评分店名:"}},[a("Input",{attrs:{placeholder:"点评分店名"},model:{value:e.search_data.DianpingShopName,callback:function(t){e.$set(e.search_data,"DianpingShopName",t)},expression:"search_data.DianpingShopName"}})],1)],1)],1),e._v(" "),a("Row",[a("Col",{attrs:{span:"6"}},[a("FormItem",{attrs:{label:"途虎门店ID:"}},[a("Input",{attrs:{placeholder:"途虎门店ID"},model:{value:e.search_data.TuhuShopId,callback:function(t){e.$set(e.search_data,"TuhuShopId",t)},expression:"search_data.TuhuShopId"}})],1)],1),e._v(" "),a("Col",{attrs:{span:"6"}},[a("FormItem",{attrs:{label:"点评团购:"}},[a("Select",{model:{value:e.search_data.GroupStatus,callback:function(t){e.$set(e.search_data,"GroupStatus",t)},expression:"search_data.GroupStatus"}},[a("Option",{attrs:{value:"-1"}},[e._v("全部")]),e._v(" "),a("Option",{attrs:{value:"1"}},[e._v("已配置")]),e._v(" "),a("Option",{attrs:{value:"0"}},[e._v("未配置")])],1)],1)],1),e._v(" "),a("Col",{attrs:{span:"6"}},[a("FormItem",{attrs:{label:"关联点评管家:"}},[a("Select",{model:{value:e.search_data.LinkStatus,callback:function(t){e.$set(e.search_data,"LinkStatus",t)},expression:"search_data.LinkStatus"}},[a("Option",{attrs:{value:"-1"}},[e._v("全部")]),e._v(" "),a("Option",{attrs:{value:"1"}},[e._v("已关联")]),e._v(" "),a("Option",{attrs:{value:"0"}},[e._v("未关联")]),e._v(" "),a("Option",{attrs:{value:"2"}},[e._v("即将过期")])],1)],1)],1)],1),e._v(" "),a("Row",{staticStyle:{"margin-bottom":"15px"}},[a("Button",{staticStyle:{"margin-left":"8px",float:"left"},attrs:{type:"primary"},on:{click:function(t){e.page.current=1,e.loadData()}}},[e._v("查询")]),e._v(" "),a("Button",{staticStyle:{"margin-left":"8px",float:"left"},attrs:{type:"ghost"},on:{click:e.handleResetForm}},[e._v("重置")]),e._v(" "),a("Button",{staticStyle:{"margin-left":"8px",float:"left"},attrs:{type:"success"},on:{click:function(t){e.modal.edit=!1,e.modal.visible=!0,e.modal.title="新增大众点评门店"}}},[e._v("新增")]),e._v(" "),a("Upload",{staticStyle:{"margin-left":"8px",display:"inline",float:"left"},attrs:{action:"/dianping/upload?type=shopconfig",format:["xlsx","xls"],"on-format-error":e.handleFormatError,"max-size":200,"on-success":e.uploadSuccess}},[a("Button",{attrs:{type:"warning",icon:"ios-cloud-upload-outline"}},[e._v("批量导入")])],1),e._v(" "),a("a",{staticStyle:{"margin-left":"8px","margin-top":"7px",display:"inline",float:"left"},attrs:{href:"/Dianping/ExportSample?type=shopconfig",target:"_blank"}},[e._v("导出模板文件")])],1)],1),e._v(" "),a("Table",{ref:"shoptable",attrs:{border:"",loading:e.table.loading,columns:e.table.columns,data:e.table.data},on:{"on-selection-change":e.selectChange}}),e._v(" "),a("div",{staticStyle:{"margin-top":"15px"}},[a("Button",{staticStyle:{"margin-left":"8px",float:"left"},attrs:{type:"success",disabled:null==e.selectedTableData||0==e.selectedTableData.length},on:{click:e.link}},[e._v("关联点评管家")]),e._v(" "),a("Page",{staticStyle:{float:"right"},attrs:{total:e.page.total,"page-size":e.page.pageSize,current:e.page.current,"page-size-opts":[20,50,100],"show-elevator":"","show-sizer":""},on:{"on-change":e.handlePageChange,"on-page-size-change":e.handlePageSizeChange}})],1),e._v(" "),a("Modal",{attrs:{loading:e.modal.loading,title:e.modal.title,okText:"提交",cancelText:"取消"},on:{"on-ok":e.ok,"on-cancel":e.cancel},model:{value:e.modal.visible,callback:function(t){e.$set(e.modal,"visible",t)},expression:"modal.visible"}},[a("Form",{ref:"modal.shopConfig",attrs:{model:e.modal.shopConfig,rules:e.modal.rules,"label-position":"left","label-width":150}},[a("FormItem",{attrs:{label:"点评门店ID",prop:"DianpingId"}},[a("Input",{attrs:{disabled:e.modal.edit,placeholder:""},model:{value:e.modal.shopConfig.DianpingId,callback:function(t){e.$set(e.modal.shopConfig,"DianpingId",t)},expression:"modal.shopConfig.DianpingId"}})],1),e._v(" "),a("FormItem",{attrs:{label:"点评商户名",prop:"DianpingName"}},[a("Input",{attrs:{placeholder:""},model:{value:e.modal.shopConfig.DianpingName,callback:function(t){e.$set(e.modal.shopConfig,"DianpingName",t)},expression:"modal.shopConfig.DianpingName"}})],1),e._v(" "),a("FormItem",{attrs:{label:"点评分店名",prop:"DianpingShopName"}},[a("Input",{attrs:{placeholder:""},model:{value:e.modal.shopConfig.DianpingShopName,callback:function(t){e.$set(e.modal.shopConfig,"DianpingShopName",t)},expression:"modal.shopConfig.DianpingShopName"}})],1),e._v(" "),a("FormItem",{attrs:{label:"途虎门店ID",prop:"TuhuShopId"}},[a("Input",{attrs:{placeholder:""},on:{"on-change":e.setShopName},model:{value:e.modal.shopConfig.TuhuShopId,callback:function(t){e.$set(e.modal.shopConfig,"TuhuShopId",t)},expression:"modal.shopConfig.TuhuShopId"}})],1),e._v(" "),a("FormItem",{attrs:{label:"途虎门店名称",prop:"TuhuShopName"}},[a("Input",{attrs:{disabled:!0,placeholder:""},model:{value:e.modal.shopConfig.TuhuShopName,callback:function(t){e.$set(e.modal.shopConfig,"TuhuShopName",t)},expression:"modal.shopConfig.TuhuShopName"}})],1),e._v(" "),a("FormItem",{attrs:{label:"点评团购",prop:"GroupStatus"}},[a("Select",{model:{value:e.modal.shopConfig.GroupStatus,callback:function(t){e.$set(e.modal.shopConfig,"GroupStatus",t)},expression:"modal.shopConfig.GroupStatus"}},e._l(e.select_data,function(t){return a("Option",{key:t.value,attrs:{value:t.value}},[e._v(e._s(t.text))])}))],1)],1)],1),e._v(" "),a("Modal",{attrs:{title:"删除",loading:e.deleteModal.loading},on:{"on-ok":e.deleteok},model:{value:e.deleteModal.visible,callback:function(t){e.$set(e.deleteModal,"visible",t)},expression:"deleteModal.visible"}},[a("p",[e._v("确认删除？")])])],1)},staticRenderFns:[]};var S=a("VU/8")(I,D,!1,function(e){a("aa2m")},null,null).exports;a.d(t,"page404",function(){return k}),a.d(t,"page403",function(){return x}),a.d(t,"page500",function(){return C}),n.default.use(o.a);var k={path:"/*",name:"error-404",meta:{title:"404-页面不存在"},component:function(){return a.e(1).then(a.bind(null,"LWjT"))}},x={path:"/403",meta:{title:"403-权限不足"},name:"error-403",component:function(){return a.e(0).then(a.bind(null,"J7+d"))}},C={path:"/500",meta:{title:"500-服务端错误"},name:"error-500",component:function(){return a.e(2).then(a.bind(null,"0Gql"))}};t.default=new o.a({routes:[{path:"/",name:"index",component:s,meta:{title:"首页"}},{path:"/dianping/gpconfig",name:"gpconfig",component:m,meta:{title:"团购配置",authpath:"/dianping/getgroupconfigs"}},{path:"/dianping/shopconfig",name:"shopconfig",component:S,meta:{title:"门店维护",authpath:"/dianping/getshopconfigs"}},x,C,k]})},aa2m:function(e,t){},bh8J:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.a1e6a77e82925b902d74.js.map