function connectWebViewJavascriptBridge(n){window.WebViewJavascriptBridge?n(WebViewJavascriptBridge):document.addEventListener("WebViewJavascriptBridgeReady",function(){n(WebViewJavascriptBridge)},!1)}function VersionForIos(n){IosVersion=n}function VersionForAndroid(n){AndroidVersion=n}var AirConditionFilter,userAgentInfo;$(function(){$(".details ul").on("click",".prdetail",function(){ClickCount++;$(this).attr("kv")=="ikv"?$(this).hasClass("selected")?$(this).removeClass("selected"):($(".prdetail").each(function(){$(this).attr("kv")=="ikv"&&$(this).removeClass("selected")}),$(this).addClass("selected")):$(this).attr("kv")=="okv"&&($(this).hasClass("selected")?$(this).removeClass("selected"):($(".prdetail").each(function(){$(this).attr("kv")=="okv"&&$(this).removeClass("selected")}),$(this).addClass("selected")));SelectedAllProduct=[];$(".prdetail").each(function(){$(this).hasClass("selected")&&SelectedAllProduct.push(JSON.parse($(this).find(".data").text()))});TotalPrice=0;for(var n in SelectedAllProduct)TotalPrice+=parseFloat(SelectedAllProduct[n].Price);$(".settle .leftbtn .total").find("em").html("\u00a5"+TotalPrice.toFixed(2))});$(".selectbrand").on("click",function(n){n.preventDefault();setTimeout(function(){$(".searchPage").show().addClass("slidein").removeClass("slideout")},350)});$(".searchPage").on("click",".search .close",function(){setTimeout(function(){$(".searchPage").removeClass("slidein").addClass("slideout")},350)});$(".searchPage").on("click",".search .queding",function(){var t=[],n,i;if($(".listItem a").each(function(n,i){$(this).hasClass("selected")&&t.push($(i).find("em").text())}),n=[],t.length>0)if(t.indexOf("\u5168\u90e8")>=0)n=ProductListAll;else for(i in ProductListAll)t.indexOf(ProductListAll[i].Brand)>=0&&n.push(ProductListAll[i]);else n=ProductListAll;AirConditionFilter.CreateHtml(n);$(".searchResult a").removeClass("selected");setTimeout(function(){$(".searchPage").removeClass("slidein").addClass("slideout")},350)});$(".searchPage").on("click",".searchResult a",function(){$(this).hasClass("totalbrand")?$(this).toggleClass("selected").siblings().removeClass("selected"):($(".searchResult a.totalbrand").removeClass("selected"),$(this).toggleClass("selected"))});$(".settle .rightbtn").on("click",function(){var u,f,i,h,e,o,n,t,r,s;if(ClickCount==0&&SelectedAllProduct.length<=0)SelectedAllProduct.push(SelectedProduct),TotalPrice=SelectedProduct.Price;else if(ClickCount!=0&&SelectedAllProduct.length<=0)return!1;if(console.log(JSON.stringify(SelectedAllProduct)),userAgentInfo.indexOf("Android")>=0)if(AndroidVersion.localeCompare("4.9.0")>=0){var u=[],f=[],a=[];for(n in SelectedAllProduct){var t={orderTitle:"",orderNum:0,orderPrice:"",BeiJingPrice:"",ProductID:"",VariantID:"",produteImg:"",type:"",CP_UnitP:"",ActivityId:""},i={Item:"",count:""},c={BaoYangType:"",Products:""};t.orderTitle=SelectedAllProduct[n].DisplayName;t.orderNum=SelectedAllProduct[n].Quantity;t.orderPrice=SelectedAllProduct[n].Price;t.BeiJingPrice="";t.ProductID=SelectedAllProduct[n].ProductID;t.VariantID=SelectedAllProduct[n].VariantID;t.produteImg=SelectedAllProduct[n].Image;t.CP_UnitP=SelectedAllProduct[n].CP_UnitP;t.ActivityId="";i.Item=SelectedAllProduct[n].ProductID+"|"+SelectedAllProduct[n].VariantID;i.count=SelectedAllProduct[n].Quantity;u.push(t);f.push(i);c.BaoYangType=SelectedAllProduct[n].Type;c.Products=f;a.push(c)}h={typeService:JSON.stringify(a),FunctionID:"cn.TuHu.Activity.OrderSubmit.OrderConfirmUI",Goods:u,quanType:2,orderType:2,Car:DefaultCar};window.WebViewJavascriptBridge.callHandler("toOrder",encodeURIComponent(encodeURIComponent(JSON.stringify(h))))}else{u=[];f=[];for(n in SelectedAllProduct)t={orderTitle:"",orderNum:0,orderPrice:"",BeiJingPrice:"",ProductID:"",VariantID:"",produteImg:"",type:"",CP_UnitP:"",ActivityId:""},i={Type:"",Count:""},t.orderTitle=SelectedAllProduct[n].DisplayName,t.orderNum=SelectedAllProduct[n].Quantity,t.orderPrice=SelectedAllProduct[n].Price,t.BeiJingPrice="",t.ProductID=SelectedAllProduct[n].ProductID,t.VariantID=SelectedAllProduct[n].VariantID,t.produteImg=SelectedAllProduct[n].Image,t.CP_UnitP=SelectedAllProduct[n].CP_UnitP,t.ActivityId="",i.Type=SelectedAllProduct[n].Type,i.Count=SelectedAllProduct[n].Quantity,u.push(t),f.push(i);h={FunctionID:"cn.TuHu.Activity.OrderSubmit.OrderConfirmUI",Goods:u,typeService:f,quanType:2,orderType:2,Car:DefaultCar};window.WebViewJavascriptBridge.callHandler("toOrder",encodeURIComponent(encodeURIComponent(JSON.stringify(h))))}else if(IosVersion.localeCompare("IOS3.3.5")>=0){var e=[],o=[],v=[];for(n in SelectedAllProduct){var t={productID:"",variantID:"",name:"",image:"",price:"",count:0},r={Item:"",Count:0},l={BaoYangType:"",Products:""};t.productID=SelectedAllProduct[n].ProductID;t.variantID=SelectedAllProduct[n].VariantID;t.name=SelectedAllProduct[n].DisplayName;t.image=SelectedAllProduct[n].Image;t.price=SelectedAllProduct[n].Price;t.count=SelectedAllProduct[n].Quantity;r.Item=SelectedAllProduct[n].ProductID+"|"+SelectedAllProduct[n].VariantID;r.Count=SelectedAllProduct[n].Quantity;e.push(t);o.push(r);l.BaoYangType=SelectedAllProduct[n].Type;l.Products=o;v.push(l)}s={"goods<THGoods>":e,totalPrice:TotalPrice,orderType:2,orderAddressType:1,maintainTypes:v,activityId:""};AirConditionFilter.iosend("tuhuaction://segue#THCreatOrderVC#",JSON.stringify(s))}else{e=[];o=[];for(n in SelectedAllProduct)t={productID:"",variantID:"",name:"",image:"",price:"",count:0},r={type:"",count:0},t.productID=SelectedAllProduct[n].ProductID,t.variantID=SelectedAllProduct[n].VariantID,t.name=SelectedAllProduct[n].DisplayName,t.image=SelectedAllProduct[n].Image,t.price=SelectedAllProduct[n].Price,t.count=SelectedAllProduct[n].Quantity,r.type=SelectedAllProduct[n].Type,r.count=SelectedAllProduct[n].Quantity,e.push(t),o.push(r);s={"goods<THGoods>":e,totalPrice:TotalPrice,orderType:2,orderAddressType:1,maintainTypes:o,activityId:""};console.log(JSON.stringify(s));AirConditionFilter.iosend("tuhuaction://segue#THCreatOrderVC#",JSON.stringify(s))}});AirConditionFilter.Login()});AirConditionFilter={GetAirConditionFilterData:function(n,t,i,r,u,f){$.ajax({method:"GET",url:DomainBy+"api/ChangeMaintenanceProduct.html",data:{type:"ikv",PaiLiang:t,Nian:i,TID:r,LiYangID:f,VehicleID:n},dataType:"jsonp"}).done(function(u){u.Code=="1"?(ProductListAll=u.ProductList,$.ajax({method:"GET",url:DomainBy+"api/ChangeMaintenanceProduct.html",data:{type:"okv",PaiLiang:t,Nian:i,TID:r,LiYangID:f,VehicleID:n},dataType:"jsonp"}).done(function(n){var i,u,r,f,t;if(n.Code=="1"&&n.ProductList.length>0)for(t in n.ProductList)ProductListAll.push(n.ProductList[t]);if(ProductListAll.length>0){i=[];u=[];for(t in ProductListAll)r={Brand:"",BrandImage:""},u.indexOf(ProductListAll[t].Brand)<0&&(u.push(ProductListAll[t].Brand),r.Brand=ProductListAll[t].Brand,r.BrandImage=ProductListAll[t].BrandImage,i.push(r));f='<a class="totalbrand selected"><span><\/span><em>\u5168\u90e8<\/em><\/a>';for(t in i)f+=' <a class=""><img src="'+i[t].BrandImage+'" /><em>'+i[t].Brand+"<\/em><\/a>  ";$(".listItem").html(f);AirConditionFilter.CreateHtml(ProductListAll)}else AirConditionFilter.NoneProduct()})):AirConditionFilter.NoneProduct()}).fail(function(){})},Login:function(){userAgentInfo.indexOf("Android")>=0?window.WebViewJavascriptBridge.callHandler("actityBridge",{param:""},function(n){n!=null&&AirConditionFilter.CallBackAppLoginResponse(n)}):AirConditionFilter.iosend("tuhuaction://getuserinfo#1#","AirConditionFilter.CallBackAppLoginResponse")},CallBackAppLoginResponse:function(n){var t=null;t=userAgentInfo.indexOf("Android")>=0?JSON.parse(n):n;UserId=t.userid;Phone=t.phone;AirConditionFilter.SelectCarObject(t.userid)},SelectCarObject:function(n){$.ajax({method:"GET",url:DomainItem+"CarHistory/SelectCarObject.html",data:{userID:n},dataType:"jsonp",async:!1}).done(function(n){var t,i;if(n.Code=="1"&&n.CarHistory.length>0)for(t in n.CarHistory)if(n.CarHistory[t].IsDefaultCar=="1")if(DefaultCar=n.CarHistory[t],CarId=n.CarHistory[t].CarID,LIYANGID=n.CarHistory[t].LIYANGID,Nian=n.CarHistory[t].Nian,Pailiang=n.CarHistory[t].Pailiang,TID=n.CarHistory[t].TID,ProductID=n.CarHistory[t].ProductID,Vehicle=n.CarHistory[t].Vehicle,Brand=n.CarHistory[t].Brand,VehicleLogin="http://image.tuhu.cn"+n.CarHistory[t].VehicleLogin,SalesName=n.CarHistory[t].SalesName,i=Pailiang+" "+Nian,$("#plNian").html(i),$(".car-info img").attr("src",VehicleLogin),$(".car-info .other .type").html(i),$(".car-info .other .name").html(Vehicle),ProductID!=""&&Pailiang=="")AirConditionFilter.GetPailiang(ProductID);else{TID=="null"||TID==null||TID==""?AirConditionFilter.GetTID(CarId,ProductID,Pailiang,Nian):AirConditionFilter.GetAirConditionFilterData(ProductID,Pailiang,Nian,TID,Brand,LIYANGID,SalesName,Vehicle);break}else if(DefaultCar=n.CarHistory[0],CarId=n.CarHistory[0].CarID,LIYANGID=n.CarHistory[0].LIYANGID,Nian=n.CarHistory[0].Nian,Pailiang=n.CarHistory[0].Pailiang,TID=n.CarHistory[0].TID,ProductID=n.CarHistory[0].ProductID,Vehicle=n.CarHistory[0].Vehicle,Brand=n.CarHistory[0].Brand,VehicleLogin="http://image.tuhu.cn"+n.CarHistory[0].VehicleLogin,SalesName=n.CarHistory[0].SalesName,i=Pailiang+" "+Nian,$("#plNian").html(i),$(".car-info img").attr("src",VehicleLogin),$(".car-info .other .type").html(i),$(".car-info .other .name").html(Vehicle),ProductID!=""&&Pailiang=="")AirConditionFilter.GetPailiang(ProductID);else{TID=="null"||TID==null||TID==""?AirConditionFilter.GetTID(CarId,ProductID,Pailiang,Nian):AirConditionFilter.GetAirConditionFilterData(ProductID,Pailiang,Nian,TID,Brand,LIYANGID,SalesName,Vehicle);break}else userAgentInfo.indexOf("Android")>=0?window.WebViewJavascriptBridge.callHandler("setUserCarInfo",function(){}):AirConditionFilter.iosend("tuhuaction://getcar#5#0#","AirConditionFilter.carCallback")}).fail(function(){})},carCallback:function(){window.location.reload(!0)},iosend:function(n,t){window.location.href=n+encodeURIComponent(t)},GetTID:function(n,t,i,r){$.ajax({method:"GET",url:DomainItem+"Car/SelectVehicle",data:{VehicleID:t,PaiLiang:i,Nian:r},dataType:"jsonp",async:!1}).done(function(n){n.Code=="1"?AirConditionFilter.NoneProduct():n.Code=="0"&&AirConditionFilter.GetWuJi(t,i,r)}).fail(function(){})},UpdateDefultCar:function(n,t,i,r,u){$.ajax({method:"GET",url:DomainItem+"CarHistory/UpdateCarObject.html",data:{CarID:n,ProductID:t,IsDefaultCar:!0,TID:u,UserID:UserId,Pailiang:i,Nian:r,PropertyList:""},dataType:"json"}).done(function(){}).fail(function(){})},GetWuJi:function(n,t,i){$.ajax({method:"GET",url:DomainItem+"Car/GetVehicleSalesName",data:{VehicleID:n,PaiLiang:t,Nian:i},dataType:"jsonp",async:!1}).done(function(n){if(n.Code=="1"){if(TID=n.SalesName[0].TID,TID==null||TID=="null"||TID=="")return AirConditionFilter.NoneProduct(),!1;AirConditionFilter.GetAirConditionFilterData(ProductID,Pailiang,Nian,TID,Brand,LIYANGID,SalesName,Vehicle)}else NoneProduct()})},GetPailiang:function(n){$.ajax({url:DomainItem+"Car/SelectVehicle",type:"GET",data:{VehicleID:n,PaiLiang:"",Nian:""},dataType:"jsonp",async:!1}).done(function(n){return n.Code=="1"?userAgentInfo.indexOf("Android")>=0?window.WebViewJavascriptBridge.callHandler("setUserCarInfo",function(){}):AirConditionFilter.iosend("tuhuaction://getcar#5#0#","AirConditionFilter.carCallback"):n.Code=="0"&&AirConditionFilter.NoneProduct(),!1})},UniqueCategory:function(n){for(var i=[],r={},u=0,t;(t=n[u])!=null;u++)r[t]||(i.push(t),r[t]=!0);return i},GetQueryString:function(n){var i=new RegExp("(^|&)"+n+"=([^&]*)(&|$)","i"),t=window.location.search.substr(1).match(i);return t!=null?unescape(t[2]):null},SetCookie:function(n,t){var i=new Date;i.setTime(i.getTime()+864e5);document.cookie=n+"="+escape(t)+";path=/;expires="+i.toGMTString()},GetCookie:function(n){var t=document.cookie.match(new RegExp("(^| )"+n+"=([^;]*)(;|$)"));return t!=null?unescape(t[2]):null},CreateHtml:function(n){var i="",t,r;$(".details ul").html(i);for(t in n)n[t].HasStock&&(r="",n[t].Type=="ikv"?r=" <em>\u5185\u7f6e<\/em>":n[t].Type=="okv"&&(r=" <em>\u5916\u7f6e<\/em>"),i+='<li><div class="prdetail" kv="'+n[t].Type+'"><p class="data" style="display:none">'+JSON.stringify(n[t])+'<\/p><div class="product clearfix"><span class="list-img"><img src="'+n[t].Image+'"><\/span><h3><span class="name">'+n[t].DisplayName+r+'<\/span><\/h3><div class="price">\u00a5'+n[t].Price+'<\/div><\/div><span class="xuanzhong"><\/span><\/div><\/li>');$(".details ul").html(i);i&&($(".details ul li .prdetail").eq(0).addClass("selected"),SelectedProduct=JSON.parse($(".details ul li .prdetail").eq(0).find(".data").text()),$(".settle .leftbtn .total").find("em").html("\u00a5"+SelectedProduct.Price))},NoneProduct:function(){$(".details").html('<img src="images/no-product.png"><p>\u6682\u65e0\u9002\u914d\u4ea7\u54c1<\/p>');$(".details").css({"text-align":"center","margin-top":"25%",display:"block",color:"red"})}};userAgentInfo=navigator.userAgent;connectWebViewJavascriptBridge(function(n){n.init(function(n,t){t({"Javascript Responds":"Wee!"})});n.registerHandler("functionInJs",function(n,t){t("Javascript Says Right back aka!")})});var TID="",VehicleLogin="",Vehicle="",UserId="",Phone="",CarId="",LIYANGID="",Nian="",Pailiang="",ProductID="",Brand="",SalesName="",SelectedProduct="",SelectedAllProduct=[],TotalPrice=0,ClickCount=0,ProductListAll="",DefaultCar="",DomainItem="http://item.tuhu.cn/",DomainBy="http://by.tuhu.cn/",IosVersion="",AndroidVersion="";