@using Tuhu.Component.Common.Extensions
@using Tuhu.Provisioning.Models
@using Tuhu.Provisioning.Business;
@model Tuhu.Component.Common.Models.ListModel<Tuhu.Provisioning.DataAccess.Entity.FlashSalesTwo>
@{
    ViewBag.Title = "H5限时抢购";
    Layout = "../Shared/_Layout.cshtml";

    IFlashSalesTwoManager manager = new FlashSalesTwoManager();
}
<style>
    .ui-dialog {
        border-radius: 3px;
        padding: 0px;
        width: auto;
    }

    .ui-dialog-grid {
        width: 100%;
    }

    .ui-dialog-title {
        width: 75%;
        padding: 8px 15px 8px 15px;
    }

    .ui-dialog-close {
        top: 8px;
    }

    .ui-dialog-body {
        padding: 10px;
    }

    .ui-dialog-content {
        padding: 0px;
    }

    .ui-dialog-footer {
        padding: 5px 10px 5px 5px;
        background: #ffffff;
        border-top: 1px solid #eee;
    }

        .ui-dialog-footer button {
            padding: 3px 15px;
            border-radius: 2px;
            box-shadow: 0 1px 1px rgba(0,0,0,.15);
            font-size: 12px;
        }

            .ui-dialog-footer button.ui-dialog-autofocus {
                font-weight: 700;
                text-shadow: 1px 1px 1px rgba(0,0,0,0.2);
            }

    .button1 {
        margin-top: 20px;
        padding: 5px 25px;
        border: none;
        color: #F0F0F0;
        font-size: 12px;
        font-family: "Microsoft Yahei";
        outline: none;
        cursor: pointer;
        background: #0088cc;
        border-color: #0088cc;
    }

    table th {
        color: white;
        padding: 6px 5px;
        text-align: left;
        background-color: #0088cc;
        border: solid 1px #0088cc;
    }

    input[type='text'] {
        width: 100%;
    }

    input[type='date'] {
        width: 100%;
    }
</style>
<h2>H5限时抢购</h2>
<script src="../../Scripts/ajaxfileupload.js" type="text/javascript"></script>
<div style="margin-top:20px;">
    <table style="width:auto;">
        <tbody>         
            <tr>
                <td>ActivityTime:</td>
                <td><input type="date" id="StartAct" /></td>
                <td>TO</td>
                <td><input type="date" id="EndAct" /></td>
                <td>UpdateTime:</td>
                <td><input type="date" id="StartUpdate" /></td>
                <td>TO</td>
                <td><input type="date" id="EndUpdate" /></td>              
            </tr>
            <tr>
                <td>ActivityID:</td>
                <td><input type="text" id="ActivityID" /></td>
                <td>Title:</td>
                <td><input type="text" id="titlename" /></td>
                <td><input type="button" value="查询" class="button1" onclick="Search()" /></td>
            </tr>
        </tbody>
    </table>
</div>
<div style="margin-top:20px;">

    <table style="width:100%;">
        <thead>
            <tr>
                <th>ID</th>
                <th>Title</th>
                <th>UpdateTime</th>
                <th>StartTime</th>
                <th>EndTime</th>
                <th>Url</th>
                <th>操作</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var item in Model)
            {
                <tr>
                    <td>@item.ActivityID</td>
                    <td>@item.ActivityName</td>
                    <td>@item.UpdateDateTime</td>
                    <td>@item.StartDateTime</td>
                    <td>@item.EndDateTime</td>
                    <td>
                        
                        <a href="https://wx.tuhu.cn/react/flashsale/#/?_k=seckill&activity=@item.ActivityID&time=@item.IsNoActiveTime" target="_blank">
                            https://wx.tuhu.cn/react/flashsale/#/?_k=seckill&activity=@item.ActivityID&time=@item.IsNoActiveTime
                        </a>

                    </td>

                    <td>
                        <a href="javascript:void(0);" onclick="btnAdd('@item.ActivityID')">编辑</a>
                        <a href="/FlashSalesTwo/FlashSalesProductV1?ActivityID=@item.ActivityID">产品集合设置(@(manager.GetCountByFlashSalesID(item.ActivityID)))</a>

                    </td>
                </tr>
            }

        </tbody>
    </table>
</div>
<div id="AddItem" style="display: none"></div>
<div>
    @Html.Pager(Model.Pager, pageIndex => Url.RouteUrl(new { pageIndex }))
</div>
<script>
    function btnAdd(ActivityID) {
        if (ActivityID != "") {
            $("#AddItem").load('/FlashSalesTwo/AddFlashSalesV1?ActivityID=' + ActivityID + "&t=" + (+new Date));
        }
        $("#AddItem").dialog({
            title: "限时抢购活动管理",
            width: 600,
            height: 640,
            modal: true
        });
    }
    function Search() {
        var id = $("#ActivityID").val().toString();
        window.location.href = '/FlashSalesTwo/FlashSalesV1?ActivityID=' + id +
            "&ActivityName=" + $("#titlename").val() +
            "&StartAct=" + $("#StartAct").val() +
            "&EndAct=" + $("#EndAct").val() +
            "&StartUpdate=" + $("#StartUpdate").val() +
            "&EndUpdate=" + $("#EndUpdate").val()
    }

</script>
