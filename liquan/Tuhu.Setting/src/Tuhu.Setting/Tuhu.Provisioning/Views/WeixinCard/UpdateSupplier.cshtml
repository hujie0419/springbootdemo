@model Tuhu.Provisioning.DataAccess.Entity.SupplierInfo
@{ 
    Layout = null;
}
@{
    ViewBag.Title = "UpdateSupplier";
}
<script type="text/javascript">

function showImg(url) {
    var frameid = 'frameimg' + Math.random();
    console.debug(frameid);
    console.debug(url);

    window.img = '<img id="img" style="width:100%;height:100%" src=\'' + url + '?' + Math.random() + '\' /><script>window.onload = function() { parent.document.getElementById(\'' + frameid + '\').height = document.getElementById(\'img\').height+\'px\'; }<' + '/script>';
    document.write('<iframe id="' + frameid + '" src="javascript:parent.img;" frameBorder="0" scrolling="no" width="50%"></iframe>');

}

function SizeImg(url) {
   
    var img = document.getElementById('img1');
    img.src = url + '?' + Math.random();    
}
</script>
<h2>更新商户</h2>
<table>
    @*<tr>
        <th width="100%" style="text-align:left;" colspan="2">优惠券领取规则配置</th>
    </tr>*@
    <tr>
        
        <td>
            商户标志
            </td>
        <td>
            @Html.HiddenFor(m=>m.pkid,new { @class="bgpkidText"})
        
          
            <img src="@String.Format("data:image/png;base64,{0}", Model.Imgbase64string)" style="width:30%;height:30%" />
           
            </td>
        </tr>

    <tr>
        <td>
            商户名称
        </td>
        <td>
            @Html.TextBoxFor(m => m.brand_name, new { @class = "bgbrandText" })
            @*@Html.HiddenFor(m => m.lastUpdatetime, new { @class = "bgtimeText" })*@
        </td>
    </tr>
</table>
<div class="button" style="display:none;">保存</div>

<script>
    $(function () {

        $(".button").click(function () {

            var button = $(this);
            button.css("pointer-events", "none");
            var pkid = $(".bgpkidText").val(),//优惠券名字
               logourl = $(".bgLogoText").val(),//优惠券描述
               brandname = $(".bgbrandText").val();//优惠券面额


            var r = confirm("是否确定保存信息？");
            if (r) {
                $.ajax({
                    url: "/WeixinCard/UpdateSupplier",
                    type: "post",
                    // dataType: "json",

                    data: {
                        pkid: pkid,
                        logo_url: logourl,
                        brand_name: brandname
                    },
                    success: function (result) {
                        if (result > 0) {
                            alert("更新成功！");
                            @*$.get("/WebSiteActivity/InsertHistoryAction", { ActiveID: 0, ObjectType: "AddGetRule", AfterValue: result, Operation: "@(Model!=null?"UPDATE":"ADD")" }, function () { });*@
                            window.location.reload();
                        }
                    }
                });
            }
            else {
                button.css("pointer-events", "all");
            }
        })



        });
</script>